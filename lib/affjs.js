!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("affjs",[],t):"object"==typeof exports?exports.affjs=t():e.affjs=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})});var i=n(8);Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})});var a=n(9);Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})});var o=n(6);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})});var s=n(1);Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})});var u=n(5);Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})});var l=n(2);Object.keys(l).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return l[e]}})});var f=n(7);Object.keys(f).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return f[e]}})})},function(e,t){"use strict";function n(e,t){this.ev_type=e,this.fn=t}function r(e,t){return new n(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Event=n,t.on=r},function(e,t){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.State=function(){function e(){r(this,e)}return i(e,[{key:"get",value:function(){}},{key:"update",value:function(){}},{key:"beforePatch",value:function(){}},{key:"argsChanged",value:function(){}}]),e}(),t.SubState=function(){function e(t,n){r(this,e),this.app=t,this.path=n}return i(e,[{key:"get",value:function(){return this.app.get(this.path)}},{key:"update",value:function(){for(var e,t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];return(e=this.app).update.apply(e,n(this.path).concat(r))}},{key:"sub",value:function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];var a=r;return 1==a.length&&Array.isArray(a[0])&&(a=a[0]),new e(this.app,[].concat(n(this.path),n(a)))}}]),e}()},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.all_tags=["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","bgsound","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","command","content","data","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","element","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","head","header","hgroup","hr","html","h1","h2","h3","h4","h5","h6","h7","i","iframe","image","img","input","ins","isindex","kbd","keygen","label","legend","li","link","listing","main","map","mark","marquee","menu","menuitem","meta","meter","multicol","nav","nobr","noembed","noframes","noscript","object","ol","optgroup","option","output","p","param","picture","plaintext","pre","progress","q","rp","rt","rtc","ruby","s","samp","script","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr","xmp","a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","audio","canvas","circle","clipPath","color-profile","cursor","defs","desc","discard","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignObject","g","glyph","glyphRef","hatch","hatchpath","hkern","iframe","image","line","linearGradient","marker","mask","mesh","meshgradient","meshpatch","meshrow","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","solidcolor","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","unknown","use","video","view","vkern"]},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0==t.length)throw["no arguments to t()"];var r=new b;switch(f(t[0])){case"string":r.name=t[0],r.func=t[1],r.args=t.slice(2);break;case"function":r.func=t[0],r.args=t.slice(1),r.name=r.func.name}if(!r.func)throw["invalid thunk func",r.func];return r}function s(e){if("string"!=typeof e)throw["bad tag name",e];var t=new _;t.tag=e;for(var n=arguments.length,i=Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];for(var o=0;o<i.length;o++){var s=i[o];s instanceof _||s instanceof b?t.setChildren(s):s instanceof p.Selector?t.setSelector(s.str):s instanceof p.Css?t.setProperties({style:s.str}):s instanceof d.Event?t.setProperties(r({},"on"+s.ev_type,s.fn)):"object"===("undefined"==typeof s?"undefined":f(s))&&null!==s?Array.isArray(s)?t.setChildren(s):t.setProperties(s):t.setChildren(s)}return t}function u(e,t,n){var r=e.__aff_events;r||(r={},e.__aff_events=r);var i=t.split(/[$:]/);t=i[0];var a=i.slice(1).join(":")||"__default";return t in r||(r[t]={}),a in r[t]||e.addEventListener(t.substr(2),function(e){return r[t][a](e)}),r[t][a]=n,t+":"+a}Object.defineProperty(t,"__esModule",{value:!0}),t.setAfterThunkCallFunc=t.setBeforeThunkCallFunc=t.App=void 0;var l=function(){function e(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.t=o,t.e=s;var h=n(3),p=n(6),d=n(1),y=n(5),v=n(2),b=(t.App=function(){function e(){a(this,e),this.node=null,this.patching=!1,this.updated=!1,this.update_count=0,this.element_cache={};for(var t=0;t<h.all_tags.length;t++)this.element_cache[h.all_tags[t]]=[];this.init.apply(this,arguments)}return c(e,[{key:"init",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0;r<t.length;r++){var i=t[r];i instanceof HTMLElement?this.element=i:"function"==typeof i?this.node_func=i:(this._state=new y.MutableState(i,this),this.setupUses(this._state.get()))}void 0!==this.element&&void 0!==this.node_func&&void 0!==this._state&&this.update()}},{key:"setupUses",value:function(e,t,n){function r(e,t,n){var r=n.slice(0);r.pop(),t in e||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:function(){return e.__aff_tick=c.get(r).__aff_tick,c.get(n)},set:function(e){c.update.apply(c,i(n).concat([e]))}}),e.__aff_use_keys||Object.defineProperty(e,"__aff_use_keys",{configurable:!1,writable:!0,enumerable:!1,value:{}}),e.__aff_use_keys[t]=!0}if("object"===("undefined"==typeof e?"undefined":f(e))&&null!==e&&!Array.isArray(e)){t=t||[],n=n||[];var a=void 0;if("$use"in e){var o=e.$use;if("object"!==("undefined"==typeof o?"undefined":f(o))||null===o)throw["bad use",o];if(Array.isArray(o)){a={};for(var s=0;s<o.length;s++){var u=o[s];if(u in e)throw["use key conflict",u];a[u]=u}}else{for(var l in o)if(l in e)throw["use key conflict",l];a=o}delete e.$use}var c=this;for(var h in a){for(var p=a[h],d=!1,y=0;y<n.length;y++){var v=n[y];if(p in v){d=!0;for(var b=v[p].slice(0),g=0,m=0;m<b.length&&m<t.length&&b[m]==t[m];m++)g++;if(g==b.length||g==t.length)throw["loop in $use",t,b];b.pop();for(var _=b.length,k=t.slice(0);k.length>_;)r(this.get(k),h,v[p]),k.pop()}}if(!d)throw["no state named "+p]}var A={};for(var j in e){var w=t.slice(0);w.push(j),A[j]=w}n=n.slice(0),n.push(A);for(var O in e){var P=t.slice(0);P.push(O),this.setupUses(e[O],P,n)}}}},{key:"beforeUpdate",value:function(){}},{key:"afterUpdate",value:function(){}},{key:"update",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.updateMulti(t)}},{key:"updateMulti",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0;r<t.length;r++){var a,o=t[r];this.beforeUpdate.apply(this,[this.state].concat(i(o))),(a=this._state).update.apply(a,i(o)),this.afterUpdate.apply(this,[this.state].concat(i(o)))}if(!this.element)return this.state;if(this.patching)this.updated=!0,this.update_count++;else{this.patching=!0,this.updated=!1,this.update_count=0,this._state.beforePatch();var s=this.patch(this.element,this.node_func(this.state),this.node),u=l(s,2);for(this.element=u[0],this.node=u[1];this.updated;){if(this.update_count>4096)throw["infinite loop in updating",t];this.updated=!1,this._state.beforePatch();var f=this.patch(this.element,this.node_func(this.state),this.node),c=l(f,2);this.element=c[0],this.node=c[1]}this.patching=!1,this.update_count=0}return this.state}},{key:"tap",value:function(e){var t=e(this.state);t&&this.update.apply(this,i(Array.isArray(t)?t:[t]))}},{key:"html",value:function(){return this.element.innerHTML}},{key:"get",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t;1==r.length&&Array.isArray(r[0])&&(r=r[0]);for(var i=this.state,a=0;a<r.length;a++)i=i[r[a]];return i}},{key:"sub",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t;return 1==r.length&&Array.isArray(r[0])&&(r=r[0]),new v.SubState(this,r)}},{key:"patch",value:function(e,t,n){var r=void 0;n&&n instanceof b&&(r=n,n=r.node);var i=void 0;if(t instanceof b&&(i=t),i){var a=!1;r?i.name!=r.name?a=!0:this._state.argsChanged(i.args,r.args)&&(a=!0):a=!0,r&&!a&&(i.node=r.node,i.element=r.element),t=i.getNode()}if(t instanceof b||n instanceof b)return this.patch(e,t,n);if(t===n)return[e,t];if(!n||!e||t.tag!=n.tag){var o=void 0;return t&&t.toElement?o=t.toElement(void 0,this):(o=k("RENDER ERROR: cannot render "+t).toElement(),console.warn("cannot render",t)),e&&e.parentNode&&(e.parentNode.insertBefore(o,e),e.parentNode.removeChild(e)),n&&this.element_cache[e.tagName.toLowerCase()].push([e,n]),[o,t]}return t.element=e,i&&(i.element=e),this.patchNode(e,t,n)}},{key:"patchNode",value:function(e,t,n){t.innerHTML!=n.innerHTML&&(e.innerHTML=t.innerHTML),t.text!=n.text&&(e.nodeValue=t.text),t.id!=n.id&&(e.id=t.id);var r=f(t.style),i=f(n.style);if(r!==i){if("string"===r)e.style=t.style;else if("object"===r&&null!==t.style){e.style=void 0;for(var a in t.style)e.style[a]=t.style[a]}}else if("object"===r){if(null!==t.style)for(var o in t.style)n.style&&t.style[o]==n.style[o]||(e.style[o]=t.style[o]);if(null!==n.style)for(var s in n.style)t.style&&s in t.style||(e.style[s]="")}else"string"===r&&t.style!==n.style&&(e.style=t.style);for(var c in t.class)n.class&&t.class[c]==n.class[c]||(t.class[c]?e.classList.add(c):e.classList.remove(c));for(var h in n.class)t.class&&h in t.class||e.classList.remove(h);for(var p in t.attributes)if(!n.attributes||t.attributes[p]!=n.attributes[p]){var d=t.attributes[p],y="undefined"==typeof d?"undefined":f(d);"string"==y||"number"==y?(e.setAttribute(p,d),e[p]=d):"boolean"==y&&(d?(e.setAttribute(p,!0),e[p]=!0):(e.removeAttribute(p),e[p]=!1))}for(var v in n.attributes)t.attributes&&v in t.attributes||(e.removeAttribute(v),e[v]=void 0);var b={};for(var g in t.events){var m=u(e,g,t.events[g].bind(t));b[m]=!0}if(e.__aff_events)for(var _ in e.__aff_events)for(var k in e.__aff_events[_])_+":"+k in b||(e.__aff_events[_][k]=!1);for(var A=e.childNodes,j=t.children?t.children.length:0,w=n&&n.children?n.children.length:0,O=0;O<j;O++){var P=this.patch(A[O],t.children[O],n&&n.children?n.children[O]:void 0),E=l(P,2),S=E[0];E[1];A[O]||e.appendChild(S)}for(var M=j;M<w;M++)e.removeChild(e.childNodes[j]);return t.hooks&&t.hooks.patched&&t.hooks.patched.forEach(function(t){return t(e)}),[e,t]}},{key:"state",get:function(){return this._state.get()}}]),e}(),function(){function e(){a(this,e),this.func=null,this.args=null,this.node=void 0,this.element=null,this.name=null}return c(e,[{key:"toElement",value:function(e,t){if(!this.element){var n=this.getNode();n&&n.toElement?this.element=n.toElement(this.name,t):(this.element=k("RENDER ERROR: cannot render "+n).toElement(),console.warn("cannot render",n))}return this.element}},{key:"getNode",value:function(){if(!this.node&&(g(this),this.node=this.func.apply(this,this.args),m(this),null===this.node&&(this.node=s("div",{style:{display:"none"}})),!this.node))throw["constructor of "+(this.name||"anonymous")+" returned undefined value",this];return this.node}}]),e}()),g=function(e){},m=function(e){},_=(t.setBeforeThunkCallFunc=function(e){g=e},t.setAfterThunkCallFunc=function(e){m=e},function(){function e(){a(this,e),this.tag=null,this.id=null,this.style=null,this.class=null,this.children=null,this.attributes=null,this.events=null,this.text=null,this.innerHTML=null,this.element=null,this.hooks=null}return c(e,[{key:"setSelector",value:function(e){var t=e.match(/[.#][A-Za-z][A-Za-z0-9_:-]*/g);if(t)for(var n=0,r=t.length;n<r;n++){var i=t[n];"#"==i.charAt(0)?this.id=i.substring(1):"."==i.charAt(0)&&(this.class=this.class||{},this.class[i.substring(1)]=!0)}}},{key:"setProperties",value:function(e){for(var t in e)if("id"==t||"innerHTML"==t)this[t]=e[t];else if("class"==t){this.class=this.class||{};var n=e.class;if("string"==typeof n){var r=n.match(/[A-Za-z][A-Za-z0-9_:-]*/g);if(r)for(var i=0,a=r.length;i<a;i++){var o=r[i];this.class[o]=!0}}else{if("object"!=("undefined"==typeof n?"undefined":f(n))||null===n)throw["bad class",n];if(Array.isArray(n))for(var s=0;s<n.length;s++)this.class[n[s]]=!0;else{for(var u in n)this.class[u]=n[u]}}}else"style"==t?this.style=e.style:/^on/.test(t)&&"function"==typeof e[t]?"oncreated"==t||"oncreate"==t?(this.hooks=this.hooks||{},this.hooks.created=this.hooks.created||[],this.hooks.created.push(e[t])):"onpatch"==t||"onpatched"==t?(this.hooks=this.hooks||{},this.hooks.patched=this.hooks.patched||[],this.hooks.patched.push(e[t])):(this.events=this.events||{},this.events[t]=e[t]):(this.attributes=this.attributes||{},this.attributes[t]=e[t])}},{key:"setChildren",value:function(t){this.children=this.children||[];var n="undefined"==typeof t?"undefined":f(t);if("object"===n&&null!==t)if(Array.isArray(t))for(var r=0,i=t.length;r<i;r++)this.setChildren(t[r]);else this.children.push(t);else if("boolean"===n||"number"===n||"string"===n||"symbol"===n){var a=new e;a.text=t.toString(),this.children.push(a)}else{if("function"!==n)throw["bad child",t];this.setChildren(t())}}},{key:"toElement",value:function(e,t){var n=this,r=void 0;if(null!==this.text)r=document.createTextNode(this.text);else{if(t&&t.element_cache[this.tag]&&t.element_cache[this.tag].length>0){var i=function(){var e=t.element_cache[n.tag].pop(),r=l(e,2),i=r[0],a=r[1],o=void 0,s=t.patchNode(i,n,a),u=l(s,2);return i=u[0],o=u[1],n.element=i,n.hooks&&n.hooks.created&&n.hooks.created.forEach(function(e){return e(i)}),{v:i}}();if("object"===("undefined"==typeof i?"undefined":f(i)))return i.v}r=document.createElement(this.tag)}if(null!==this.innerHTML&&(r.innerHTML=this.innerHTML),null!==this.id&&(r.id=this.id),null!==this.style)if("object"==f(this.style)&&null!==this.style)for(var a in this.style)r.style[a]=this.style[a];else r.style=this.style;if(null!==this.class){var o="";for(var s in this.class)this.class[s]&&(o=o+s+" ");r.className=o.trim()}if(null!==this.children){for(var c=document.createDocumentFragment(),h=0,p=this.children.length;h<p;h++)this.children[h]&&this.children[h].toElement?c.appendChild(this.children[h].toElement(void 0,t)):(c.appendChild(k("RENDER ERROR: cannot render "+this.children[h]).toElement()),console.warn("cannot render",this.children[h]));r.appendChild(c)}if(null!==this.attributes)for(var d in this.attributes){var y=this.attributes[d],v="undefined"==typeof y?"undefined":f(y);"string"==v||"number"==v?(r.setAttribute(d,y),r[d]=y):"boolean"==v&&(y?(r.setAttribute(d,!0),r[d]=!0):(r.removeAttribute(d),r[d]=!1))}if(null!==this.events)for(var b in this.events)u(r,b,this.events[b].bind(this));return this.element=r,this.hooks&&this.hooks.created&&this.hooks.created.forEach(function(e){return e(r)}),r}}]),e}()),k=function(e){return s("div",{style:{backgroundColor:"yellow",color:"red",fontWeight:"bold"}},e)}},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){return"object"!==("undefined"==typeof e?"undefined":u(e))||null===e?e:(Object.defineProperty(e,"__aff_read_only",{configurable:!1,enumerable:!1,writable:!1,value:!0}),e)}Object.defineProperty(t,"__esModule",{value:!0}),t.MutableState=void 0;var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.readOnly=s;var f=n(2);t.MutableState=function(e){function t(e,n){i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.app=n,r.patch_tick=1,r.dirty_tree={},r.next_dirty_tree={},r.state=e,r.setupState(r.state,[]),r}return o(t,e),l(t,[{key:"get",value:function(){return this.state}},{key:"update",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this.state=this.updateState.apply(this,[this.next_dirty_tree,[],this.state].concat(t))}},{key:"updateState",value:function(e,t,n){for(var i=arguments.length,a=Array(i>3?i-3:0),o=3;o<i;o++)a[o-3]=arguments[o];if(0===a.length)return n;if(1===a.length){var s=void 0;return"object"===u(a[0])&&null!==a[0]&&a[0].__is_op?(s=a[0].apply(n,this),s===n&&this.setupPatchTick(s)):s=a[0],this.setupState(s,t),s}if(n||(n={}),"object"===("undefined"==typeof n?"undefined":u(n))&&null!==n){n.hasOwnProperty("__aff_tick")||this.setupPatchTick(n);var l=a[0],f="undefined"==typeof l?"undefined":u(l);for(var c in n)if("number"!==f&&"string"!==f||c!=l){if("function"===f&&l(c)){e[c]||(e[c]={});var h=t.slice(0);h.push(c),n[c]=this.updateState.apply(this,[e[c],h,n[c]].concat(r(a.slice(1))))}}else{e[c]||(e[c]={});var p=t.slice(0);p.push(c),n[c]=this.updateState.apply(this,[e[c],p,n[c]].concat(r(a.slice(1))))}if(!("string"!==f&&"number"!==f||l in n)){e[l]||(e[l]={});var d=t.slice(0);d.push(l),n[l]=this.updateState.apply(this,[e[l],d,void 0].concat(r(a.slice(1))))}return n.__aff_tick=this.patch_tick+1,n}throw["bad update path",n,a]}},{key:"beforePatch",value:function(){this.patch_tick++,this.dirty_tree=this.next_dirty_tree,this.next_dirty_tree={}}},{key:"setupPatchTick",value:function(e){e.hasOwnProperty("__aff_tick")?e.__aff_tick=this.patch_tick+1:Object.defineProperty(e,"__aff_tick",{configurable:!1,enumerable:!1,writable:!0,value:this.patch_tick+1})}},{key:"argsChanged",value:function(e,t){var n="undefined"==typeof e?"undefined":u(e),r="undefined"==typeof t?"undefined":u(t);if(n!==r)return!0;if(e===t&&"object"===("undefined"==typeof e?"undefined":u(e))&&null!=e&&e.__aff_use_keys)for(var i in e.__aff_use_keys)e[i];if(e instanceof f.SubState&&t instanceof f.SubState){for(var a=-1,o=-1,s=this.dirty_tree,l=t.path,c=0;c<e.path.length;c++)s&&s[e.path[c]]&&(s=s[e.path[c]],a=c),l[c]==e.path[c]&&(o=c);if(a==e.path.length-1)return!0;if(o!=e.path.length-1)return!0}else{if(e===t&&"object"===("undefined"==typeof e?"undefined":u(e))&&null!==e&&e.__aff_tick===this.patch_tick)return!0;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!=t.length)return!0;for(var h=0;h<e.length;h++)if(this.argsChanged(e[h],t[h]))return!0}else if("object"===n){if(Object.keys(e).length!=Object.keys(t).length)return!0;for(var p in e)if(this.argsChanged(e[p],t[p]))return!0}else if("function"===n){if(e.name!==t.name)return!0}else if(e!==t)return!0}return!1}},{key:"setupState",value:function(e,t){var n=this;if("object"==("undefined"==typeof e?"undefined":u(e))&&null!==e&&!e.__aff_read_only){e.hasOwnProperty("$update")?e.$path=t.slice(0):!function(){var i=n.app;Object.defineProperty(e,"$update",{configurable:!1,enumerable:!1,writable:!1,value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.update.apply(i,r(this.$path).concat(t)),i.get(this.$path)}}),Object.defineProperty(e,"$sub",{configurable:!1,enumerable:!1,writable:!1,value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.sub.apply(i,r(this.$path).concat(t))}}),Object.defineProperty(e,"$path",{configurable:!1,enumerable:!1,writable:!0,value:t.slice(0)})}();for(var i in e){var a=t.slice(0);a.push(i),this.setupState(e[i],a)}}}}]),t}(f.State)},function(e,t){"use strict";function n(e){this.str=e}function r(e){for(var t="",r=arguments.length,i=Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];for(var o=0;o<e.length;o++)t+=e[o],void 0!==i[o]&&(t+=i[o]);return new n(t)}function i(e){this.str=e}function a(e){for(var t="",n=arguments.length,r=Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];for(var o=0;o<e.length;o++)t+=e[o],void 0!==r[o]&&(t+=r[o]);return new i(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Selector=n,t.$=r,t.Css=i,t.css=a},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e){var t,n=e.path.join(":");return t={},r(t,"onfocus$"+n,function(){e.update(!0)}),r(t,"onblur$"+n,function(){e.update(!1)}),t}function a(e){var t,n=e.path.join(":");return t={},r(t,"onmouseenter$"+n,function(){e.update(!0)}),r(t,"onmouseleave$"+n,function(){e.update(!1)}),t}function o(e){var t,n=e.path.join(":");return t={},r(t,"onmouseover$"+n,function(){e.update(!0)}),r(t,"onmouseout$"+n,function(){e.update(!1)}),t}Object.defineProperty(t,"__esModule",{value:!0}),t.bindHover=void 0,t.bindFocus=i,t.bindEnter=a,t.bindOver=o;n(1),t.bindHover=o},function(e,t){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){return function(){for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return{__is_op:!0,op:e,args:r,apply:function(e){return t.apply(e,r),e}}}}function i(e,t){return function(){for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return{__is_op:!0,op:e,args:r,apply:function(e){return t.apply(e,r)}}}}function a(e,t){return{__is_op:!0,op:e,apply:function(e){return t.apply(e),e}}}function o(e){return!0}var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(e){return{__is_op:!0,op:"func",args:[e],apply:function(t){return e(t)}}},l=function(e){return{__is_op:!0,op:"delete",args:[e],apply:function(t){return delete t[e],t}}},f=l,c={__is_op:!0,op:"inc",apply:function(e){return(e||0)+1}},h={__is_op:!0,op:"dec",apply:function(e){return e-1}},p={};[["push",Array.prototype.push],["unshift",Array.prototype.unshift],["splice",Array.prototype.splice],["fill",Array.prototype.fill],["sort",Array.prototype.sort]].forEach(function(e){p["$"+e[0]]=r.apply(void 0,n(e))}),[["filter",Array.prototype.filter],["map",Array.prototype.map]].forEach(function(e){p["$"+e[0]]=i.apply(void 0,n(e))}),[["pop",Array.prototype.pop],["shift",Array.prototype.shift],["reverse",Array.prototype.reverse]].forEach(function(e){p["$"+e[0]]=a.apply(void 0,n(e))}),e.exports=s({$func:u,$delete:l,$del:f,$inc:c,$dec:h},p,{$any:o})},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(4),a=n(3),o=a.all_tags.reduce(function(e,t){return e[t]=function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return i.e.apply(void 0,[t].concat(n))},e[t.charAt(0).toUpperCase()+t.slice(1)]=e[t],e[t.toUpperCase()]=e[t],e},{}),s=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.e.apply(void 0,["input",{type:"checkbox"}].concat(t))};e.exports=r({},o,{none:(0,i.e)("div",{style:{display:"none"}}),clear:(0,i.e)("div",{style:{clear:"both"}}),checkbox:s,Checkbox:s,CHECKBOX:s})}])});
//# sourceMappingURL=affjs.js.map