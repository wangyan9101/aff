{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap fa0a522d2559bcbab8d5","webpack:///./index.js","webpack:///./app.js","webpack:///./all_tags.js","webpack:///./tagged.js","webpack:///./event.js","webpack:///./mutable_state.js","webpack:///./state.js","webpack:///./operations.js","webpack:///./tags.js","webpack:///./bind.js","webpack:///./debug.js"],"names":["t","e","App","node","patching","updated","update_count","element_cache","i","length","events","init","args","arg","HTMLElement","element","addEvent","node_func","_state","setupUses","get","undefined","update","obj","path","scopes","Array","isArray","useInfos","use","key","app","set_user_getter","from","parentPathOfFrom","slice","pop","Object","defineProperty","configurable","enumerable","set","v","__aff_use_keys","writable","value","name","found","bindings","stop_path","same_len","idx","stop_length","setup_path","p","push","ev","parts","ev_type","split","ev_subtype","join","fn","sub_type","apply","updateMulti","dispatchEvent","state","beforePatch","patch","innerHTML","last_element","last_node","last_thunk","Thunk","thunk","should_update","argsChanged","getNode","tag","toElement","warning","console","warn","parentNode","insertBefore","removeChild","tagName","toLowerCase","patchNode","text","nodeValue","id","style_type","style","last_style_type","classList","add","remove","attributes","valueType","setAttribute","removeAttribute","event_keys","k","elementSetEvent","bind","__aff_events","child_elements","childNodes","child_len","children","last_child_len","elem","_","appendChild","hooks","patched","forEach","func","_name","beforeThunkCallFunc","afterThunkCallFunc","display","Node","setChildren","setSelector","str","setProperties","setBeforeThunkCallFunc","setAfterThunkCallFunc","selector","match","l","part","charAt","substring","properties","property","test","created","type","child","toString","document","createTextNode","createElement","className","trim","childFragment","createDocumentFragment","backgroundColor","color","fontWeight","addEventListener","substr","ret","all_tags","Selector","Css","makeTagger","constructor","strings","values","$","css","Event","on","MutableState","init_state","patch_tick","setupState","updateState","base_path","__is_op","setupPatchTick","hasOwnProperty","key_type","__aff_tick","last_arg","arg_type","last_arg_type","fromPath","tick","keys","__aff_read_only","$path","reduce","acc","cur","sub_path","readOnly","State","make_argumented_method_op","method","op","make_argumented_method_op_new_value","make_method_op","$func","$delete","prop","$del","$inc","$dec","array_ops","prototype","unshift","splice","fill","sort","info","filter","map","shift","reverse","$any","module","exports","helpers","toUpperCase","checkbox","none","clear","Checkbox","CHECKBOX","bindFocus","bindEnter","bindOver","$update","bindHover","logUpdates","log","formatUpdatePath","formatUpdateArg"],"mappings":"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","file":"affjs.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"affjs\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"affjs\"] = factory();\n\telse\n\t\troot[\"affjs\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap fa0a522d2559bcbab8d5","export * from './app';\nexport * from './operations';\nexport * from './tags';\nexport * from './tagged';\nexport * from './event';\nexport * from './mutable_state';\nexport * from './state';\nexport * from './bind';\nexport * from './debug';\n\n\n\n// WEBPACK FOOTER //\n// ./index.js","import { all_tags } from './all_tags'\nimport { Selector, Css } from './tagged'\nimport { Event } from './event'\nimport { MutableState } from './mutable_state'\n\nexport class App {\n  constructor(...args) {\n    this.node = null;\n    this.patching = false;\n    this.updated = false;\n    this.update_count = 0;\n    this.element_cache = {};\n    for (let i = 0; i < all_tags.length; i++) {\n      this.element_cache[all_tags[i]] = [];\n    }\n    this.events = {};\n    this.init(...args);\n  }\n\n  init(...args) {\n    for (let i = 0; i < args.length; i++) {\n      const arg = args[i];\n      if (arg instanceof HTMLElement) {\n        this.element = arg;\n      } else if (arg instanceof Event) {\n        this.addEvent(arg);\n      } else if (typeof arg == 'function') {\n        this.node_func = arg;\n      } else {\n        this._state = new MutableState(arg, this);\n        this.setupUses(this._state.get());\n      }\n    }\n    if (\n      this.element !== undefined \n      && this.node_func !== undefined \n      && this._state !== undefined\n    ) {\n      this.update();\n    }\n  }\n\n  setupUses(obj, path, scopes) {\n    // skip non-object\n    if (typeof obj !== 'object' || obj === null || Array.isArray(obj)) {\n      return\n    }\n\n    // default arguments\n    path = path || [];\n    scopes = scopes || [];\n\n    // parse $use\n    let useInfos;\n    if ('$use' in obj) {\n      const use = obj['$use'];\n      if (typeof use === 'object' && use !== null) {\n        if (Array.isArray(use)) {\n          useInfos = {};\n          for (let i = 0; i < use.length; i++) {\n            const key = use[i];\n            if (key in obj) {\n              throw['use key conflict', key];\n            }\n            useInfos[key] = key;\n          }\n        } else {\n          for (const key in use) {\n            if (key in obj) {\n              throw['use key conflict', key];\n            }\n          }\n          useInfos = use;\n        }\n        delete obj['$use'];\n      } else {\n        throw['bad use', use];\n      }\n    }\n\n    const app = this;\n    function set_user_getter(obj, key, from) {\n      const parentPathOfFrom = from.slice(0);\n      parentPathOfFrom.pop();\n      if (!(key in obj)) {\n        Object.defineProperty(obj, key, {\n          configurable: false,\n          enumerable: true,\n          get: function() {\n            return app.get(from);\n          },\n          set: function(v) {\n            app.update(...from, v);\n          },\n        });\n      }\n      if (!obj.__aff_use_keys) {\n        Object.defineProperty(obj, '__aff_use_keys', {\n          configurable: false,\n          writable: true,\n          enumerable: false,\n          value: {},\n        });\n      }\n      obj.__aff_use_keys[key] = from;\n    }\n\n    // setup\n    for (const key in useInfos) {\n      const name = useInfos[key];\n      // search in scopes\n      let found = false;\n      for (let i = 0; i < scopes.length; i++) {\n        const bindings = scopes[i];\n        if (name in bindings) { // found\n          found = true;\n          let stop_path = bindings[name].slice(0);\n          // check loop\n          let same_len = 0;\n          for (let idx = 0; idx < stop_path.length && idx < path.length; idx++) {\n            if (stop_path[idx] == path[idx]) {\n              same_len++\n            } else {\n              break\n            }\n          }\n          if (same_len == stop_path.length || same_len == path.length) {\n            throw['loop in $use', path, stop_path];\n          }\n          stop_path.pop();\n          const stop_length = stop_path.length;\n          let setup_path = path.slice(0);\n          while (setup_path.length > stop_length) {\n            //console.log('get', setup_path, key, 'from', bindings[name]);\n            set_user_getter(this.get(setup_path), key, bindings[name]);\n            setup_path.pop();\n          }\n        }\n      }\n      if (!found) {\n        throw[`no state named ${name}`];\n      }\n    }\n\n    // collect bindings\n    const bindings = {};\n    for (const key in obj) {\n      const p = path.slice(0);\n      p.push(key);\n      bindings[key] = p;\n    }\n    scopes = scopes.slice(0); // copy\n    scopes.push(bindings);\n\n    // recursively\n    for (let key in obj) {\n      let p = path.slice(0);\n      p.push(key);\n      this.setupUses(obj[key], p, scopes);\n    }\n\n  }\n\n  addEvent(ev) {\n    const parts = ev.ev_type.split(/[$:]/);\n    const ev_type = parts[0];\n    const ev_subtype = parts.slice(1).join(':') || '__default';\n    if (!(ev_type in this.events)) {\n      this.events[ev_type] = {};\n    }\n    const events = this.events[ev_type];\n    events[ev_subtype] = ev.fn;\n  }\n\n  dispatchEvent(ev_type, ...args) {\n    for (const sub_type in this.events[ev_type]) {\n      this.events[ev_type][sub_type].apply(this, args);\n    }\n  }\n\n  get state() {\n    return this._state.get();\n  }\n\n  update(...args) {\n    return this.updateMulti(args);\n  }\n\n  updateMulti(...args) {\n    for (let i = 0; i < args.length; i++) {\n      let arg = args[i];\n      this.dispatchEvent('before_update', this.state, ...arg);\n      this._state.update(...arg);\n      this.dispatchEvent('after_update', this.state, ...arg);\n    }\n    if (!this.element) {\n      return this.state;\n    }\n    if (!this.patching) {\n      this.patching = true;\n      this.updated = false;\n      this.update_count = 0;\n      this._state.beforePatch();\n      [this.element, this.node] = this.patch(\n        this.element, \n        this.node_func(this.state), \n        this.node,\n      );\n      while (this.updated) {\n        if (this.update_count > 4096) { // infinite loop\n          throw['infinite loop in updating', args];\n        }\n        // if state is updated when patching, patch again\n        this.updated = false;\n        this._state.beforePatch();\n        [this.element, this.node] = this.patch(\n          this.element,\n          this.node_func(this.state),\n          this.node,\n        );\n      }\n      this.patching = false;\n      this.update_count = 0;\n    } else {\n      // state updated when patching\n      this.updated = true;\n      this.update_count++;\n    }\n    return this.state;\n  }\n\n  html() {\n    return this.element.innerHTML;\n  }\n\n  get(...args) {\n    let path = args;\n    if (path.length == 1 && Array.isArray(path[0])) {\n      path = path[0];\n    }\n    let obj = this.state;\n    for (let i = 0; i < path.length; i++) {\n      obj = obj[path[i]];\n    }\n    return obj;\n  }\n\n  // patch last_element to represent node attributes, with diffing last_node\n  patch(last_element, node, last_node) {\n    // thunk\n    let last_thunk;\n    if (last_node && last_node instanceof Thunk) {\n      last_thunk = last_node;\n      last_node = last_thunk.node;\n    }\n    let thunk;\n    if (node instanceof Thunk) {\n      thunk = node;\n    }\n\n    if (thunk) {\n      let should_update = false;\n      if (!last_thunk) {\n        should_update = true;\n      } else if (thunk.name != last_thunk.name) {\n        should_update = true;\n      } else if (this._state.argsChanged(thunk.args, last_thunk.args)) {\n        should_update = true;\n      }\n\n      if (last_thunk && !should_update) {\n        // reuse node\n        thunk.node = last_thunk.node;\n        // reuse element\n        thunk.element = last_thunk.element;\n      }\n      node = thunk.getNode();\n    }\n\n    // Thunk.getNode may return another Thunk, patch recursively\n    if (node instanceof Thunk || last_node instanceof Thunk) {\n      return this.patch(last_element, node, last_node);\n    }\n\n    // no need to patch if two Nodes is the same object\n    // if thunk's node is reuse, will return here\n    if (node === last_node) {\n      return [last_element, node];\n    }\n\n    // not patchable, build a new element\n    if (\n      // not diffable\n      (!last_node)\n      // no element\n      || (!last_element)\n      // different tag, no way to patch\n      || (node.tag != last_node.tag)\n    ) {\n      let element;\n      if (!node || !node.toElement) {\n        element = warning(`RENDER ERROR: cannot render ${node}`).toElement();\n        console.warn('cannot render', node);\n      } else {\n        element = node.toElement(undefined, this);\n      }\n      // insert new then remove old\n      if (last_element && last_element.parentNode) {\n        last_element.parentNode.insertBefore(element, last_element);\n        last_element.parentNode.removeChild(last_element);\n      }\n      // cache last_element\n      if (last_node) {\n        this.element_cache[last_element.tagName.toLowerCase()].push([last_element, last_node]);\n      }\n\n      return [element, node];\n    }\n\n    // set element\n    node.element = last_element;\n    if (thunk) {\n      thunk.element = last_element;\n    }\n\n    return this.patchNode(last_element, node, last_node);\n  }\n\n  patchNode(last_element, node, last_node) {\n    // innerHTML\n    if (node.innerHTML != last_node.innerHTML) {\n      last_element.innerHTML = node.innerHTML;\n    }\n\n    // text\n    if (node.text != last_node.text) {\n      last_element.nodeValue = node.text;\n    }\n\n    // id\n    if (node.id != last_node.id) {\n      last_element.id = node.id;\n    }\n\n    // styles\n    const style_type = typeof node.style;\n    const last_style_type = typeof last_node.style;\n    // different type, no diff\n    if (style_type !== last_style_type) {\n      if (style_type === 'string') {\n        last_element.style = node.style;\n      } else if (style_type === 'object' && node.style !== null) {\n        last_element.style = undefined;\n        for (const key in node.style) {\n          last_element.style[key] = node.style[key];\n        }\n      }\n    } \n    // diff object\n    else if (style_type === 'object') {\n      if (node.style !== null) {\n        for (const key in node.style) {\n          if (!last_node.style || node.style[key] != last_node.style[key]) {\n            last_element.style[key] = node.style[key];\n          }\n        }\n      }\n      if (last_node.style !== null) {\n        for (const key in last_node.style) {\n          if (!node.style || !(key in node.style)) {\n            last_element.style[key] = '';\n          }\n        }\n      }\n    } \n    // string, compare\n    else if (style_type === 'string') {\n      if (node.style !== last_node.style) {\n        last_element.style = node.style;\n      }\n    }\n\n    // class\n    for (const key in node.classList) {\n      // should update\n      if (!last_node.classList || node.classList[key] != last_node.classList[key]) {\n        if (node.classList[key]) {\n          last_element.classList.add(key);\n        } else {\n          last_element.classList.remove(key);\n        }\n      }\n    }\n    for (const key in last_node.classList) {\n      if (!node.classList || !(key in node.classList)) {\n        last_element.classList.remove(key);\n      }\n    }\n\n    // attributes\n    for (const key in node.attributes) {\n      if (!last_node.attributes || node.attributes[key] != last_node.attributes[key]) {\n        const value = node.attributes[key];\n        const valueType = typeof value;\n        if (valueType == 'string' || valueType == 'number') {\n          last_element.setAttribute(key, value);\n          last_element[key] = value\n        } else if (valueType == 'boolean') {\n          if (value) {\n            last_element.setAttribute(key, true);\n            last_element[key] = true;\n          } else {\n            last_element.removeAttribute(key);\n            last_element[key] = false;\n          }\n        }\n      }\n    }\n    for (const key in last_node.attributes) {\n      if (!node.attributes || !(key in node.attributes)) {\n        last_element.removeAttribute(key);\n        last_element[key] = undefined;\n      }\n    }\n\n    // events\n    const event_keys = {};\n    for (const key in node.events) {\n      let k = elementSetEvent(last_element, key, node.events[key].bind(node));\n      event_keys[k] = true;\n    }\n    if (last_element.__aff_events) {\n      for (const ev_type in last_element.__aff_events) {\n        for (const ev_subtype in last_element.__aff_events[ev_type]) {\n          if (!(ev_type + ':' + ev_subtype in event_keys)) {\n            delete last_element.__aff_events[ev_type][ev_subtype];\n          }\n        }\n      }\n    }\n\n    // children\n    const child_elements = last_element.childNodes;\n    const child_len = node.children ? node.children.length : 0;\n    const last_child_len = last_node && last_node.children ? last_node.children.length : 0;\n    for (let i = 0; i < child_len; i++) {\n      const [elem, _] = this.patch(\n        child_elements[i], \n        node.children[i], \n        last_node && last_node.children ? last_node.children[i] : undefined,\n      );\n      if (!child_elements[i]) {\n        last_element.appendChild(elem);\n      }\n    }\n    for (let i = child_len; i < last_child_len; i++) {\n      last_element.removeChild(last_element.childNodes[child_len]);\n    }\n\n    if (node.hooks && node.hooks.patched) {\n      node.hooks.patched.forEach(fn => fn(last_element));\n    }\n\n    return [last_element, node];\n  }\n}\n\nclass Thunk {\n  constructor() {\n    this.func = null;\n    this.args = null;\n    this.node = undefined;\n    this.element = null;\n    this.name = null;\n  }\n\n  toElement(_name, app) {\n    if (!this.element) {\n      const node = this.getNode();\n      if (!node || !node.toElement) {\n        this.element = warning(`RENDER ERROR: cannot render ${node}`).toElement();\n        console.warn('cannot render', node);\n      } else {\n        this.element = node.toElement(this.name, app);\n      }\n    }\n    return this.element;\n  }\n\n  getNode() {\n    if (!this.node) {\n      beforeThunkCallFunc(this);\n      this.node = this.func.apply(this, this.args);\n      afterThunkCallFunc(this);\n      if (this.node === null) {\n        this.node = e('div', { style: { display: 'none' }});\n      }\n      if (!this.node) {\n        throw['constructor of ' + (this.name || 'anonymous') + ' returned undefined value', this];\n      }\n    }\n    return this.node;\n  }\n\n}\n\n// thunk helper\nexport function t(...args) {\n  if (args.length == 0) {\n    throw['no arguments to t()'];\n  }\n  const thunk = new Thunk();\n  switch (typeof args[0]) {\n  case 'string': // named thunk\n    thunk.name = args[0];\n    thunk.func = args[1];\n    thunk.args = args.slice(2);\n    break\n  case 'function':\n    thunk.func = args[0];\n    thunk.args = args.slice(1);\n    thunk.name = thunk.func.name;\n    break\n  }\n  if (!thunk.func) {\n    throw['invalid thunk func', thunk.func];\n  }\n  return thunk\n}\n\n// element helper\nexport function e(tag, ...args) {\n  if (typeof tag !== 'string') {\n    throw['bad tag name', tag];\n  }\n  const node = new Node();\n  node.tag = tag;\n  for (let i = 0; i < args.length; i++) {\n    const arg = args[i];\n    if (arg instanceof Node || arg instanceof Thunk) {\n      node.setChildren(arg);\n    } else if (arg instanceof Selector) {\n      node.setSelector(arg.str);\n    } else if (arg instanceof Css) {\n      node.setProperties({\n        style: arg.str,\n      });\n    } else if (arg instanceof Event) {\n      node.setProperties({\n        ['on' + arg.ev_type]: arg.fn,\n      });\n    } else if (typeof arg === 'object' && arg !== null) {\n      if (Array.isArray(arg)) {\n        node.setChildren(arg)\n      } else {\n        node.setProperties(arg);\n      }\n    } else {\n      node.setChildren(arg);\n    }\n  }\n  return node;\n}\n\nlet beforeThunkCallFunc = (thunk) => {};\nlet afterThunkCallFunc = (thunk) => {};\nexport const setBeforeThunkCallFunc = (fn) => {\n  beforeThunkCallFunc = fn;\n}\nexport const setAfterThunkCallFunc = (fn) => {\n  afterThunkCallFunc = fn;\n}\n\nclass Node {\n  constructor() {\n    this.tag = null;\n    this.id = null;\n    this.style = null;\n    this.classList = null;\n    this.children = null;\n    this.attributes = null;\n    this.events = null;\n    this.text = null;\n    this.innerHTML = null;\n    this.element = null;\n    this.hooks = null;\n  }\n\n  setSelector(selector) {\n    const parts = selector.match(/[.#][A-Za-z][A-Za-z0-9_:-]*/g);\n    if (parts) {\n      for (let i = 0, l = parts.length; i < l; i++) {\n        const part = parts[i];\n        if (part.charAt(0) == '#') {\n          this.id = part.substring(1);\n        } else if (part.charAt(0) == '.') {\n          this.classList = this.classList || {};\n          this.classList[part.substring(1)] = true;\n        }\n      }\n    }\n  }\n\n  setProperties(properties) {\n    for (const key in properties) {\n      if (key == 'id' || key == 'innerHTML') {\n        // id, innerHTML\n        this[key] = properties[key];\n      } else if (key == 'classList') {\n        this.classList = this.classList || {};\n        const property = properties.classList;\n        if (typeof property == 'string') {\n          const parts = property.match(/[A-Za-z][A-Za-z0-9_:-]*/g);\n          if (parts) {\n            for (let i = 0, l = parts.length; i < l; i++) {\n              const part = parts[i];\n              this.classList[part] = true;\n            }\n          }\n        } else if (typeof property == 'object' && property !== null) {\n          if (Array.isArray(property)) {\n            for (let i = 0; i < property.length; i++) {\n              this.classList[property[i]] = true;\n            }\n          } else {\n            for (const k in property) {\n              this.classList[k] = property[k];\n            }\n          }\n        } else {\n          throw['bad class', property];\n        }\n      } else if (key == 'style') {\n        // styles\n        this.style = properties.style;\n      } else if (/^on/.test(key) && typeof properties[key] === 'function') {\n        if (key == 'oncreated' || key == 'oncreate') {\n          this.hooks = this.hooks || {};\n          this.hooks.created = this.hooks.created || [];\n          this.hooks.created.push(properties[key]);\n        } else if (key == 'onpatch' || key == 'onpatched') {\n          this.hooks = this.hooks || {};\n          this.hooks.patched = this.hooks.patched || [];\n          this.hooks.patched.push(properties[key]);\n        } else {\n          // events\n          this.events = this.events || {};\n          this.events[key] = properties[key];\n        }\n      } else {\n        this.attributes = this.attributes || {};\n        this.attributes[key] = properties[key];\n      }\n    }\n  }\n\n  setChildren(children) {\n    this.children = this.children || [];\n    const type = typeof children;\n    if (type === 'object' && children !== null) {\n      if (Array.isArray(children)) {\n        // flatten\n        for (let i = 0, l = children.length; i < l; i++) {\n          this.setChildren(children[i]);\n        }\n      } else {\n        this.children.push(children);\n      }\n    } else if (type === 'boolean' || type === 'number' || type === 'string' || type === 'symbol') {\n      const child = new Node();\n      child.text = children.toString();\n      this.children.push(child);\n    } else if (type === 'function') {\n      this.setChildren(children());\n    } else {\n      throw['bad child', children];\n    }\n  }\n\n  toElement(name, app) {\n    let element;\n    if (this.text !== null) {\n      element = document.createTextNode(this.text);\n    } else {\n      // use cached element\n      if (app && app.element_cache[this.tag] && app.element_cache[this.tag].length > 0) {\n        let [element, last_node] = app.element_cache[this.tag].pop();\n        let node;\n        [element, node] = app.patchNode(element, this, last_node);\n        this.element = element;\n        if (this.hooks && this.hooks.created) {\n          this.hooks.created.forEach(fn => fn(element));\n        }\n        return element;\n      }\n      element = document.createElement(this.tag);\n    }\n    if (this.innerHTML !== null) {\n      element.innerHTML = this.innerHTML;\n    }\n    if (this.id !== null) {\n      element.id = this.id;\n    }\n    if (this.style !== null) {\n      if (typeof this.style == 'object' && this.style !== null) {\n        for (const key in this.style) {\n          element.style[key] = this.style[key];\n        }\n      } else {\n        element.style = this.style;\n      }\n    }\n    if (this.classList !== null) {\n      let className = '';\n      for (let k in this.classList) {\n        if (this.classList[k]) {\n          className = className + k + ' ';\n        }\n      }\n      element.className = className.trim();\n    }\n    if (this.children !== null) {\n      const childFragment = document.createDocumentFragment();\n      for (let i = 0, l = this.children.length; i < l; i++) {\n        if (!this.children[i] || !this.children[i].toElement) {\n          childFragment.appendChild(warning(`RENDER ERROR: cannot render ${this.children[i]}`).toElement());\n          console.warn('cannot render', this.children[i]);\n        } else {\n          childFragment.appendChild(this.children[i].toElement(undefined, app));\n        }\n      }\n      element.appendChild(childFragment);\n    }\n    if (this.attributes !== null) {\n      for (const key in this.attributes) {\n        const value = this.attributes[key];\n        const valueType = typeof value;\n        if (valueType == 'string' || valueType == 'number') {\n          element.setAttribute(key, value);\n          element[key] = value;\n        } else if (valueType == 'boolean') {\n          if (value) {\n            element.setAttribute(key, true);\n            element[key] = true;\n          } else {\n            element.removeAttribute(key);\n            element[key] = false;\n          }\n        }\n      }\n    }\n    if (this.events !== null) {\n      for (const key in this.events) {\n        // set event callback, bind current Node to callback\n        // constructor must not be arrow function to get proper 'this'\n        elementSetEvent(element, key, this.events[key].bind(this));\n      }\n    }\n    this.element = element;\n    if (this.hooks && this.hooks.created) {\n      this.hooks.created.forEach(fn => fn(element));\n    }\n    return element;\n  }\n\n}\n\nconst warning = (text) => e('div', {\n  style: {\n    backgroundColor: 'yellow',\n    color: 'red',\n    fontWeight: 'bold',\n  },\n}, text);\n\nfunction elementSetEvent(element, ev_type, fn) {\n  let events = element.__aff_events;\n  if (!events) {\n    events = {};\n    element.__aff_events = events;\n  }\n  const parts = ev_type.split(/[$:]/);\n  ev_type = parts[0];\n  const ev_subtype = parts.slice(1).join(':') || '__default';\n  if (!(ev_type in events)) {\n    events[ev_type] = {};\n    element.addEventListener(ev_type.substr(2), function(ev) {\n      let ret;\n      for (const ev_subtype in events[ev_type]) {\n        ret = events[ev_type][ev_subtype](ev);\n      }\n      return ret;\n    });\n  }\n  events[ev_type][ev_subtype] = fn;\n  return ev_type + ':' + ev_subtype;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app.js","export const all_tags = [\n\n  // html\n  'a', 'abbr', 'acronym', 'address', 'applet', 'area', 'article', 'aside', 'audio',\n  'b', 'base', 'basefont', 'bdi', 'bdo', 'bgsound', 'big', 'blink', 'blockquote', 'body', 'br', 'button',\n  'canvas', 'caption', 'center', 'cite', 'code', 'col', 'colgroup', 'command', 'content',\n  'data', 'datalist', 'dd', 'del', 'details', 'dfn', 'dialog', 'dir', 'div', 'dl', 'dt',\n  'element', 'em', 'embed',\n  'fieldset', 'figcaption', 'figure', 'font', 'footer', 'form', 'frame', 'frameset',\n  'head', 'header', 'hgroup', 'hr', 'html',\n  'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'h7',\n  'i', 'iframe', 'image', 'img', 'input', 'ins', 'isindex',\n  'kbd', 'keygen',\n  'label', 'legend', 'li', 'link', 'listing',\n  'main', 'map', 'mark', 'marquee', 'menu', 'menuitem', 'meta', 'meter', 'multicol',\n  'nav', 'nobr', 'noembed', 'noframes', 'noscript',\n  'object', 'ol', 'optgroup', 'option', 'output',\n  'p', 'param', 'picture', 'plaintext', 'pre', 'progress',\n  'q',\n  'rp', 'rt', 'rtc', 'ruby',\n  's', 'samp', 'script', 'section', 'select', 'shadow', 'small', 'source', 'spacer', 'span', 'strike', 'strong', 'style', 'sub', 'summary', 'sup',\n  'table', 'tbody', 'td', 'template', 'textarea', 'tfoot', 'th', 'thead', 'time', 'title', 'tr', 'track', 'tt',\n  'u', 'ul',\n  'var', 'video',\n  'wbr',\n  'xmp',\n\n  // svg\n  'a', 'altGlyph', 'altGlyphDef', 'altGlyphItem', 'animate', 'animateColor', 'animateMotion', 'animateTransform', 'audio',\n  'canvas', 'circle', 'clipPath', 'color-profile', 'cursor',\n  'defs', 'desc', 'discard',\n  'ellipse',\n  'feBlend', 'feColorMatrix', 'feComponentTransfer', 'feComposite', 'feConvolveMatrix', 'feDiffuseLighting', 'feDisplacementMap', 'feDistantLight',\n  'feDropShadow', 'feFlood', 'feFuncA', 'feFuncB', 'feFuncG', 'feFuncR', 'feGaussianBlur', 'feImage', 'feMerge', 'feMergeNode', 'feMorphology',\n  'feOffset', 'fePointLight', 'feSpecularLighting', 'feSpotLight', 'feTile', 'feTurbulence', 'filter',\n  'font', 'font-face', 'font-face-format', 'font-face-name', 'font-face-src', 'font-face-uri', 'foreignObject',\n  'g', 'glyph', 'glyphRef',\n  'hatch', 'hatchpath', 'hkern',\n  'iframe', 'image',\n  'line', 'linearGradient',\n  'marker', 'mask', 'mesh', 'meshgradient', 'meshpatch', 'meshrow', 'metadata', 'missing-glyph', 'mpath',\n  'path', 'pattern', 'polygon', 'polyline',\n  'radialGradient', 'rect',\n  'script', 'set', 'solidcolor', 'stop', 'style', 'svg', 'switch', 'symbol',\n  'text', 'textPath', 'title', 'tref', 'tspan',\n  'unknown', 'use',\n  'video', 'view', 'vkern',\n\n];\n\n\n\n// WEBPACK FOOTER //\n// ./all_tags.js","export function Selector(str) {\n  this.str = str;\n}\n\nexport function Css(str) {\n  this.str = str;\n}\n\nfunction makeTagger(constructor) {\n  function tag(strings, ...values) {\n    let str = '';\n    for (let i = 0; i < strings.length; i++) {\n      str += strings[i];\n      if (values[i] !== undefined) {\n        str += values[i];\n      }\n    }\n    return new constructor(str);\n  }\n  return tag;\n}\n\nexport const $ = makeTagger(Selector);\nexport const css = makeTagger(Css);\n\n\n\n// WEBPACK FOOTER //\n// ./tagged.js","export function Event(ev_type, fn) {\n  this.ev_type = ev_type;\n  this.fn = fn;\n}\n\nexport function on(ev_type, fn) {\n  return new Event(ev_type, fn);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./event.js","import { State } from './state'\n\nexport class MutableState extends State {\n  constructor(init_state, app) {\n    super();\n    this.app = app;\n    this.patch_tick = 1;\n    this.state = init_state;\n    this.setupState(this.state, []);\n  }\n\n  get() {\n    return this.state;\n  }\n\n  update(...arg) {\n    this.state = this.updateState([], this.state, ...arg);\n  }\n\n  updateState(base_path, obj, ...args) {\n    if (args.length === 0) {\n      return obj;\n    } else if (args.length === 1) {\n      let ret;\n      if (typeof args[0] === 'object' && args[0] !== null && args[0].__is_op) {\n        ret = args[0].apply(obj, this);\n        if (ret === obj) {\n          this.setupPatchTick(ret);\n        }\n      } else {\n        ret = args[0];\n      }\n      this.setupState(ret, base_path);\n      return ret;\n    } else {\n      if (!obj) {\n        obj = {};\n      }\n      if (typeof obj === 'object' && obj !== null) {\n        if (!obj.hasOwnProperty('__aff_tick')) {\n          this.setupPatchTick(obj);\n        }\n        const key = args[0];\n        const key_type = typeof key;\n        for (const k in obj) {\n          if ((key_type === 'number' || key_type === 'string') && k == key) {\n            let path = base_path.slice(0);\n            path.push(k);\n            obj[k] = this.updateState(path, obj[k], ...args.slice(1));\n          } else if (key_type === 'function' && key(k)) {\n            let path = base_path.slice(0);\n            path.push(k);\n            obj[k] = this.updateState(path, obj[k], ...args.slice(1));\n          }\n        }\n        if ((key_type === 'string' || key_type === 'number') && !(key in obj)) {\n          let path = base_path.slice(0);\n          path.push(key);\n          obj[key] = this.updateState(path, undefined, ...args.slice(1));\n        }\n        obj.__aff_tick = this.patch_tick + 1;\n        return obj;\n      } else {\n        throw['bad update path', obj, args];\n      }\n    }\n  }\n\n  beforePatch() {\n    this.patch_tick++;\n  }\n\n  setupPatchTick(obj) {\n    if (obj.hasOwnProperty('__aff_tick')) {\n      obj.__aff_tick = this.patch_tick + 1;\n    } else {\n      Object.defineProperty(obj, '__aff_tick', {\n        configurable: false,\n        enumerable: false,\n        writable: true,\n        value: this.patch_tick + 1,\n      });\n    }\n  }\n\n  argsChanged(arg, last_arg) {\n    const arg_type = typeof arg;\n    const last_arg_type = typeof last_arg;\n\n    // different type\n    if (arg_type !== last_arg_type) {\n      return true;\n    }\n\n    // trigger update of used keys\n    if (\n      arg === last_arg\n      && typeof arg === 'object'\n      && arg != null\n      && arg.__aff_use_keys\n    ) {\n      for (const key in arg.__aff_use_keys) {\n        const fromPath = arg.__aff_use_keys[key].slice(0);\n        fromPath.pop();\n        const tick = this.app.get(fromPath).__aff_tick;\n        if (tick == this.patch_tick) {\n          arg.__aff_tick = tick;\n        }\n      }\n    }\n\n    // patch_tick\n    if (\n      arg === last_arg \n      && typeof arg === 'object' \n      && arg !== null \n      && arg.__aff_tick === this.patch_tick\n    ) {\n      return true;\n    }\n\n    // array\n    else if (Array.isArray(arg) && Array.isArray(last_arg)) {\n      // different length\n      if (arg.length != last_arg.length) {\n        return true;\n      }\n      // check items\n      for (let i = 0; i < arg.length; i++ ){\n        if (this.argsChanged(arg[i], last_arg[i])) {\n          return true;\n        }\n      }\n    } \n\n    // deep compare object\n    else if (arg_type === 'object') {\n      // different keys length\n      if (Object.keys(arg).length != Object.keys(last_arg).length) {\n        return true;\n      }\n      for (const key in arg) {\n        if (this.argsChanged(arg[key], last_arg[key])) {\n          return true;\n        }\n      }\n    }\n\n    // function\n    else if (arg_type === 'function') {\n      if (arg.name !== last_arg.name) {\n        return true;\n      }\n    }\n\n    // compare\n    else if (arg !== last_arg) {\n      return true;\n    }\n\n    return false;\n  }\n\n  setupState(state, base_path) {\n    if (typeof state != 'object' || state === null) {\n      return\n    }\n    if (state.__aff_read_only) {\n      return\n    }\n\n    if (!state.hasOwnProperty('$update')) {\n      // set\n      const app = this.app;\n      Object.defineProperty(state, '$update', {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: function(...args) {\n          app.update(...this.$path, ...args);\n          return app.get(this.$path);\n        },\n      });\n      Object.defineProperty(state, '$path', {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: base_path.slice(0),\n      });\n\n    } else {\n      if (!(state.$path.reduce((acc, cur, i) => \n        acc && cur == base_path[i], true))) {\n        throw['cannot change state object path', base_path.slice(0), state.$path];\n      }\n    }\n\n    // recursively\n    for (let key in state) {\n      let sub_path = base_path.slice(0);\n      sub_path.push(key);\n      this.setupState(state[key], sub_path);\n    }\n\n  }\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./mutable_state.js","export class State {\n  get() {}\n  update() {}\n  beforePatch() {}\n  argsChanged() {}\n}\n\nexport function readOnly(obj) {\n  if (typeof obj !== 'object' || obj === null) {\n    return obj;\n  }\n  Object.defineProperty(obj, '__aff_read_only', {\n    configurable: false,\n    enumerable: false,\n    writable: false,\n    value: true,\n  });\n  return obj;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./state.js","// operations \n\nfunction make_argumented_method_op(name, method) {\n  return function(...args) {\n    return {\n      __is_op: true,\n      op: name,\n      args: args,\n      apply(obj) {\n        method.apply(obj, args);\n        return obj;\n      },\n    };\n  };\n}\n\nfunction make_argumented_method_op_new_value(name, method) {\n  return function(...args) {\n    return {\n      __is_op: true,\n      op: name,\n      args: args,\n      apply(obj) {\n        return method.apply(obj, args);\n      },\n    };\n  };\n}\n\nfunction make_method_op(name, method) {\n  return {\n    __is_op: true,\n    op: name,\n    apply(obj) {\n      method.apply(obj);\n      return obj;\n    },\n  };\n}\n\nlet $func = (fn) => ({\n  __is_op: true,\n  op: 'func',\n  args: [fn],\n  apply(obj) {\n    return fn(obj);\n  },\n});\n\nlet $delete = (prop) => ({\n  __is_op: true,\n  op: 'delete',\n  args: [prop],\n  apply(obj) {\n    delete obj[prop];\n    return obj;\n  },\n});\n\nlet $del = $delete;\n\n// numbers\n\nlet $inc = {\n  __is_op: true,\n  op: 'inc',\n  apply(obj) {\n    return (obj || 0) + 1;\n  },\n};\n\nlet $dec = {\n  __is_op: true,\n  op: 'dec',\n  apply(obj) {\n    return obj - 1;\n  }\n};\n\n// arrays\n\nlet array_ops = {};\n\n[\n  ['push', Array.prototype.push],\n  ['unshift', Array.prototype.unshift],\n  ['splice', Array.prototype.splice],\n  ['fill', Array.prototype.fill],\n  ['sort', Array.prototype.sort],\n].forEach(info => {\n  array_ops['$' + info[0]] = make_argumented_method_op(...info);\n});\n\n[\n  ['filter', Array.prototype.filter],\n  ['map', Array.prototype.map],\n].forEach(info => {\n  array_ops['$' + info[0]] = make_argumented_method_op_new_value(...info);\n});\n\n[\n  ['pop', Array.prototype.pop],\n  ['shift', Array.prototype.shift],\n  ['reverse', Array.prototype.reverse],\n].forEach(info => {\n  array_ops['$' + info[0]] = make_method_op(...info);\n});\n\n// predictions\n\nfunction $any(k) {\n  return true;\n}\n\n// export\n\nmodule.exports = {\n  $func,\n  $delete,\n  $del,\n  $inc,\n  $dec,\n  ...array_ops,\n  $any,\n};\n\n\n\n// WEBPACK FOOTER //\n// ./operations.js","import {e} from './app'\nimport { all_tags } from './all_tags'\n\nconst helpers = all_tags.reduce((helpers, tag) => {\n  helpers[tag] = function(...args) {\n    return e(tag, ...args);\n  };\n  helpers[tag.charAt(0).toUpperCase() + tag.slice(1)] = helpers[tag];\n  helpers[tag.toUpperCase()] = helpers[tag];\n  return helpers;\n}, {});\n\nconst checkbox = (...args) => e('input', {\n  type: 'checkbox',\n}, ...args);\n\nmodule.exports = {\n  ...helpers,\n\n  none: e('div', {\n    style: {\n      display: 'none',\n    },\n  }),\n\n  clear: e('div', {\n    style: {\n      clear: 'both',\n    },\n  }),\n\n  checkbox: checkbox,\n  Checkbox: checkbox,\n  CHECKBOX: checkbox,\n};\n\n\n\n// WEBPACK FOOTER //\n// ./tags.js","import { on } from './event'\n\nexport function bindFocus(state, name) {\n  let path = state.$path.slice(0);\n  path.push(name);\n  path = path.join(':');\n  return {\n    ['onfocus$' + path]: function() {\n      state.$update(name, true);\n    },\n    ['onblur$' + path]: function() {\n      state.$update(name, false);\n    },\n  };\n}\n\nexport function bindEnter(state, name) {\n  let path = state.$path.slice(0);\n  path.push(name);\n  path = path.join(':');\n  return {\n    ['onmouseenter$' + path]: function() {\n      state.$update(name, true);\n    },\n    ['onmouseleave$' + path]: function() {\n      state.$update(name, false);\n    },\n  };\n}\n\nexport function bindOver(state, name) {\n  let path = state.$path.slice(0);\n  path.push(name);\n  path = path.join(':');\n  return {\n    ['onmouseover$' + path]: function() {\n      state.$update(name, true);\n    },\n    ['onmouseout$' + path]: function() {\n      state.$update(name, false);\n    },\n  };\n}\n\nexport let bindHover = bindOver;\n\n\n\n// WEBPACK FOOTER //\n// ./bind.js","import { $any } from './operations'\nimport { on } from './event'\n\nexport const logUpdates = on('after_update:__log_updates', (state, ...args) => {\n  console.log('%cUPDATE', 'background: #555; color: white', \n    args.slice(0, -1).map(arg => formatUpdatePath(arg)).join(' . ') + ' => ',\n    formatUpdateArg(args[args.length - 1]),\n  );\n});\n\nfunction formatUpdatePath(arg) {\n  if (arg === $any) {\n    return '$any';\n  } \n  return arg;\n}\n\nfunction formatUpdateArg(arg) {\n  if (typeof arg === 'object' && arg.__is_op) {\n    return [arg.op, ...(arg.args || [])];\n  }\n  return arg;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./debug.js"],"sourceRoot":""}