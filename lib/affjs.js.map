{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///affjs.js","webpack:///webpack/bootstrap a297f4884d405cca9de8","webpack:///./index.js","webpack:///./event.js","webpack:///./state.js","webpack:///./all_tags.js","webpack:///./app.js","webpack:///./mutable_state.js","webpack:///./tagged.js","webpack:///./bind.js","webpack:///./operations.js","webpack:///./tags.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","Object","defineProperty","value","_app","keys","forEach","key","enumerable","get","_operations","_tags","_tagged","_event","_mutable_state","_state","_bind","Event","ev_type","fn","on","_toConsumableArray","arr","Array","isArray","i","arr2","length","from","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","descriptor","configurable","writable","protoProps","staticProps","prototype","State","SubState","app","path","_len","arguments","args","_key","update","apply","concat","_len2","_key2","subpath","all_tags","_defineProperty","obj","t","_len6","_key17","thunk","Thunk","_typeof","name","func","slice","e","tag","node","Node","_len7","_key18","arg","setChildren","setSelector","str","setProperties","style","elementSetEvent","element","events","__aff_events","parts","split","ev_subtype","join","addEventListener","substr","ev","setAfterThunkCallFunc","setBeforeThunkCallFunc","App","undefined","_slicedToArray","sliceIterator","_arr","_n","_d","_e","_s","_i","Symbol","iterator","next","done","push","err","constructor","_all_tags","_state2","patching","updated","update_count","element_cache","init","HTMLElement","node_func","MutableState","setupUses","scopes","set_user_getter","parentPathOfFrom","pop","__aff_tick","set","v","__aff_use_keys","useInfos","use","found","bindings","stop_path","same_len","idx","stop_length","setup_path","_key6","updateMulti","_len3","_key7","beforeUpdate","state","afterUpdate","beforePatch","_patch","patch","_patch2","_patch3","_patch4","res","innerHTML","_len4","_key8","_len5","_key9","last_element","last_node","last_thunk","should_update","argsChanged","getNode","toElement","warning","console","warn","parentNode","insertBefore","removeChild","tagName","toLowerCase","patchNode","text","nodeValue","style_type","last_style_type","class","classList","add","remove","attributes","valueType","setAttribute","removeAttribute","event_keys","k","bind","child_elements","childNodes","child_len","children","last_child_len","_patch5","_patch6","elem","appendChild","hooks","patched","_name","beforeThunkCallFunc","afterThunkCallFunc","display","selector","match","l","part","charAt","substring","properties","property","test","created","type","child","toString","_this","document","createTextNode","_ret","_app$element_cache$ta","_app$element_cache$ta2","_app$patchNode","_app$patchNode2","createElement","className","trim","childFragment","createDocumentFragment","backgroundColor","color","fontWeight","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","setPrototypeOf","__proto__","readOnly","_State","init_state","getPrototypeOf","patch_tick","dirty_tree","next_dirty_tree","setupState","updateState","base_path","ret","__is_op","setupPatchTick","hasOwnProperty","key_type","last_arg","arg_type","last_arg_type","max_dirty_index","max_same_index","last_path","index","_this2","__aff_read_only","$path","_key4","_key5","sub","sub_path","Selector","$","strings","values","Css","css","bindFocus","_ref","bindEnter","_ref2","bindOver","_ref3","bindHover","make_argumented_method_op","method","op","make_argumented_method_op_new_value","make_method_op","$any","_extends","assign","source","$func","$delete","prop","$del","$inc","$dec","array_ops","unshift","splice","fill","sort","info","filter","map","shift","reverse","helpers","reduce","toUpperCase","checkbox","none","clear","Checkbox","CHECKBOX"],"mappings":"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","file":"affjs.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"affjs\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"affjs\"] = factory();\n\telse\n\t\troot[\"affjs\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"affjs\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"affjs\"] = factory();\n\telse\n\t\troot[\"affjs\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _app = __webpack_require__(4);\n\t\n\tObject.keys(_app).forEach(function (key) {\n\t  if (key === \"default\" || key === \"__esModule\") return;\n\t  Object.defineProperty(exports, key, {\n\t    enumerable: true,\n\t    get: function get() {\n\t      return _app[key];\n\t    }\n\t  });\n\t});\n\t\n\tvar _operations = __webpack_require__(8);\n\t\n\tObject.keys(_operations).forEach(function (key) {\n\t  if (key === \"default\" || key === \"__esModule\") return;\n\t  Object.defineProperty(exports, key, {\n\t    enumerable: true,\n\t    get: function get() {\n\t      return _operations[key];\n\t    }\n\t  });\n\t});\n\t\n\tvar _tags = __webpack_require__(9);\n\t\n\tObject.keys(_tags).forEach(function (key) {\n\t  if (key === \"default\" || key === \"__esModule\") return;\n\t  Object.defineProperty(exports, key, {\n\t    enumerable: true,\n\t    get: function get() {\n\t      return _tags[key];\n\t    }\n\t  });\n\t});\n\t\n\tvar _tagged = __webpack_require__(6);\n\t\n\tObject.keys(_tagged).forEach(function (key) {\n\t  if (key === \"default\" || key === \"__esModule\") return;\n\t  Object.defineProperty(exports, key, {\n\t    enumerable: true,\n\t    get: function get() {\n\t      return _tagged[key];\n\t    }\n\t  });\n\t});\n\t\n\tvar _event = __webpack_require__(1);\n\t\n\tObject.keys(_event).forEach(function (key) {\n\t  if (key === \"default\" || key === \"__esModule\") return;\n\t  Object.defineProperty(exports, key, {\n\t    enumerable: true,\n\t    get: function get() {\n\t      return _event[key];\n\t    }\n\t  });\n\t});\n\t\n\tvar _mutable_state = __webpack_require__(5);\n\t\n\tObject.keys(_mutable_state).forEach(function (key) {\n\t  if (key === \"default\" || key === \"__esModule\") return;\n\t  Object.defineProperty(exports, key, {\n\t    enumerable: true,\n\t    get: function get() {\n\t      return _mutable_state[key];\n\t    }\n\t  });\n\t});\n\t\n\tvar _state = __webpack_require__(2);\n\t\n\tObject.keys(_state).forEach(function (key) {\n\t  if (key === \"default\" || key === \"__esModule\") return;\n\t  Object.defineProperty(exports, key, {\n\t    enumerable: true,\n\t    get: function get() {\n\t      return _state[key];\n\t    }\n\t  });\n\t});\n\t\n\tvar _bind = __webpack_require__(7);\n\t\n\tObject.keys(_bind).forEach(function (key) {\n\t  if (key === \"default\" || key === \"__esModule\") return;\n\t  Object.defineProperty(exports, key, {\n\t    enumerable: true,\n\t    get: function get() {\n\t      return _bind[key];\n\t    }\n\t  });\n\t});\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.Event = Event;\n\texports.on = on;\n\tfunction Event(ev_type, fn) {\n\t  this.ev_type = ev_type;\n\t  this.fn = fn;\n\t}\n\t\n\tfunction on(ev_type, fn) {\n\t  return new Event(ev_type, fn);\n\t}\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar State = exports.State = function () {\n\t  function State() {\n\t    _classCallCheck(this, State);\n\t  }\n\t\n\t  _createClass(State, [{\n\t    key: \"get\",\n\t    value: function get() {}\n\t  }, {\n\t    key: \"update\",\n\t    value: function update() {}\n\t  }, {\n\t    key: \"beforePatch\",\n\t    value: function beforePatch() {}\n\t  }, {\n\t    key: \"argsChanged\",\n\t    value: function argsChanged() {}\n\t  }]);\n\t\n\t  return State;\n\t}();\n\t\n\tvar SubState = exports.SubState = function () {\n\t  function SubState(app, path) {\n\t    _classCallCheck(this, SubState);\n\t\n\t    this.app = app;\n\t    this.path = path;\n\t  }\n\t\n\t  _createClass(SubState, [{\n\t    key: \"get\",\n\t    value: function get() {\n\t      return this.app.get(this.path);\n\t    }\n\t  }, {\n\t    key: \"update\",\n\t    value: function update() {\n\t      var _app;\n\t\n\t      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n\t        args[_key] = arguments[_key];\n\t      }\n\t\n\t      return (_app = this.app).update.apply(_app, _toConsumableArray(this.path).concat(args));\n\t    }\n\t  }, {\n\t    key: \"sub\",\n\t    value: function sub() {\n\t      for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n\t        args[_key2] = arguments[_key2];\n\t      }\n\t\n\t      var subpath = args;\n\t      if (subpath.length == 1 && Array.isArray(subpath[0])) {\n\t        subpath = subpath[0];\n\t      }\n\t      return new SubState(this.app, [].concat(_toConsumableArray(this.path), _toConsumableArray(subpath)));\n\t    }\n\t  }]);\n\n\t  return SubState;\n\t}();\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\tvar all_tags = exports.all_tags = [\n\t\n\t// html\n\t'a', 'abbr', 'acronym', 'address', 'applet', 'area', 'article', 'aside', 'audio', 'b', 'base', 'basefont', 'bdi', 'bdo', 'bgsound', 'big', 'blink', 'blockquote', 'body', 'br', 'button', 'canvas', 'caption', 'center', 'cite', 'code', 'col', 'colgroup', 'command', 'content', 'data', 'datalist', 'dd', 'del', 'details', 'dfn', 'dialog', 'dir', 'div', 'dl', 'dt', 'element', 'em', 'embed', 'fieldset', 'figcaption', 'figure', 'font', 'footer', 'form', 'frame', 'frameset', 'head', 'header', 'hgroup', 'hr', 'html', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'h7', 'i', 'iframe', 'image', 'img', 'input', 'ins', 'isindex', 'kbd', 'keygen', 'label', 'legend', 'li', 'link', 'listing', 'main', 'map', 'mark', 'marquee', 'menu', 'menuitem', 'meta', 'meter', 'multicol', 'nav', 'nobr', 'noembed', 'noframes', 'noscript', 'object', 'ol', 'optgroup', 'option', 'output', 'p', 'param', 'picture', 'plaintext', 'pre', 'progress', 'q', 'rp', 'rt', 'rtc', 'ruby', 's', 'samp', 'script', 'section', 'select', 'shadow', 'small', 'source', 'spacer', 'span', 'strike', 'strong', 'style', 'sub', 'summary', 'sup', 'table', 'tbody', 'td', 'template', 'textarea', 'tfoot', 'th', 'thead', 'time', 'title', 'tr', 'track', 'tt', 'u', 'ul', 'var', 'video', 'wbr', 'xmp',\n\t\n\t// svg\n\t'a', 'altGlyph', 'altGlyphDef', 'altGlyphItem', 'animate', 'animateColor', 'animateMotion', 'animateTransform', 'audio', 'canvas', 'circle', 'clipPath', 'color-profile', 'cursor', 'defs', 'desc', 'discard', 'ellipse', 'feBlend', 'feColorMatrix', 'feComponentTransfer', 'feComposite', 'feConvolveMatrix', 'feDiffuseLighting', 'feDisplacementMap', 'feDistantLight', 'feDropShadow', 'feFlood', 'feFuncA', 'feFuncB', 'feFuncG', 'feFuncR', 'feGaussianBlur', 'feImage', 'feMerge', 'feMergeNode', 'feMorphology', 'feOffset', 'fePointLight', 'feSpecularLighting', 'feSpotLight', 'feTile', 'feTurbulence', 'filter', 'font', 'font-face', 'font-face-format', 'font-face-name', 'font-face-src', 'font-face-uri', 'foreignObject', 'g', 'glyph', 'glyphRef', 'hatch', 'hatchpath', 'hkern', 'iframe', 'image', 'line', 'linearGradient', 'marker', 'mask', 'mesh', 'meshgradient', 'meshpatch', 'meshrow', 'metadata', 'missing-glyph', 'mpath', 'path', 'pattern', 'polygon', 'polyline', 'radialGradient', 'rect', 'script', 'set', 'solidcolor', 'stop', 'style', 'svg', 'switch', 'symbol', 'text', 'textPath', 'title', 'tref', 'tspan', 'unknown', 'use', 'video', 'view', 'vkern'];\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.setAfterThunkCallFunc = exports.setBeforeThunkCallFunc = exports.App = undefined;\n\t\n\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\texports.t = t;\n\texports.e = e;\n\t\n\tvar _all_tags = __webpack_require__(3);\n\t\n\tvar _tagged = __webpack_require__(6);\n\t\n\tvar _event = __webpack_require__(1);\n\t\n\tvar _mutable_state = __webpack_require__(5);\n\t\n\tvar _state2 = __webpack_require__(2);\n\t\n\tfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\t\n\tfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar App = exports.App = function () {\n\t  function App() {\n\t    _classCallCheck(this, App);\n\t\n\t    this.node = null;\n\t    this.patching = false;\n\t    this.updated = false;\n\t    this.update_count = 0;\n\t    this.element_cache = {};\n\t    for (var i = 0; i < _all_tags.all_tags.length; i++) {\n\t      this.element_cache[_all_tags.all_tags[i]] = [];\n\t    }\n\t    this.init.apply(this, arguments);\n\t  }\n\t\n\t  _createClass(App, [{\n\t    key: 'init',\n\t    value: function init() {\n\t      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n\t        args[_key] = arguments[_key];\n\t      }\n\t\n\t      for (var i = 0; i < args.length; i++) {\n\t        var arg = args[i];\n\t        if (arg instanceof HTMLElement) {\n\t          this.element = arg;\n\t        } else if (typeof arg == 'function') {\n\t          this.node_func = arg;\n\t        } else {\n\t          this._state = new _mutable_state.MutableState(arg, this);\n\t          this.setupUses(this._state.get());\n\t        }\n\t      }\n\t      if (this.element !== undefined && this.node_func !== undefined && this._state !== undefined) {\n\t        this.update();\n\t      }\n\t    }\n\t  }, {\n\t    key: 'setupUses',\n\t    value: function setupUses(obj, path, scopes) {\n\t      // skip non-object\n\t      if ((typeof obj === 'undefined' ? 'undefined' : _typeof(obj)) !== 'object' || obj === null || Array.isArray(obj)) {\n\t        return;\n\t      }\n\t\n\t      // default arguments\n\t      path = path || [];\n\t      scopes = scopes || [];\n\t\n\t      // parse $use\n\t      var useInfos = void 0;\n\t      if ('$use' in obj) {\n\t        var use = obj['$use'];\n\t        if ((typeof use === 'undefined' ? 'undefined' : _typeof(use)) === 'object' && use !== null) {\n\t          if (Array.isArray(use)) {\n\t            useInfos = {};\n\t            for (var i = 0; i < use.length; i++) {\n\t              var key = use[i];\n\t              if (key in obj) {\n\t                throw ['use key conflict', key];\n\t              }\n\t              useInfos[key] = key;\n\t            }\n\t          } else {\n\t            for (var _key2 in use) {\n\t              if (_key2 in obj) {\n\t                throw ['use key conflict', _key2];\n\t              }\n\t            }\n\t            useInfos = use;\n\t          }\n\t          delete obj['$use'];\n\t        } else {\n\t          throw ['bad use', use];\n\t        }\n\t      }\n\t\n\t      var app = this;\n\t      function set_user_getter(obj, key, from) {\n\t        var parentPathOfFrom = from.slice(0);\n\t        parentPathOfFrom.pop();\n\t        if (!(key in obj)) {\n\t          Object.defineProperty(obj, key, {\n\t            configurable: false,\n\t            enumerable: true,\n\t            get: function get() {\n\t              obj.__aff_tick = app.get(parentPathOfFrom).__aff_tick;\n\t              return app.get(from);\n\t            },\n\t            set: function set(v) {\n\t              app.update.apply(app, _toConsumableArray(from).concat([v]));\n\t            }\n\t          });\n\t        }\n\t        if (!obj.__aff_use_keys) {\n\t          Object.defineProperty(obj, '__aff_use_keys', {\n\t            configurable: false,\n\t            writable: true,\n\t            enumerable: false,\n\t            value: {}\n\t          });\n\t        }\n\t        obj.__aff_use_keys[key] = true;\n\t      }\n\t\n\t      // setup\n\t      for (var _key3 in useInfos) {\n\t        var name = useInfos[_key3];\n\t        // search in scopes\n\t        var found = false;\n\t        for (var _i = 0; _i < scopes.length; _i++) {\n\t          var _bindings = scopes[_i];\n\t          if (name in _bindings) {\n\t            // found\n\t            found = true;\n\t            var stop_path = _bindings[name].slice(0);\n\t            // check loop\n\t            var same_len = 0;\n\t            for (var idx = 0; idx < stop_path.length && idx < path.length; idx++) {\n\t              if (stop_path[idx] == path[idx]) {\n\t                same_len++;\n\t              } else {\n\t                break;\n\t              }\n\t            }\n\t            if (same_len == stop_path.length || same_len == path.length) {\n\t              throw ['loop in $use', path, stop_path];\n\t            }\n\t            stop_path.pop();\n\t            var stop_length = stop_path.length;\n\t            var setup_path = path.slice(0);\n\t            while (setup_path.length > stop_length) {\n\t              //console.log('get', setup_path, key, 'from', bindings[name]);\n\t              set_user_getter(this.get(setup_path), _key3, _bindings[name]);\n\t              setup_path.pop();\n\t            }\n\t          }\n\t        }\n\t        if (!found) {\n\t          throw ['no state named ' + name];\n\t        }\n\t      }\n\t\n\t      // collect bindings\n\t      var bindings = {};\n\t      for (var _key4 in obj) {\n\t        var p = path.slice(0);\n\t        p.push(_key4);\n\t        bindings[_key4] = p;\n\t      }\n\t      scopes = scopes.slice(0); // copy\n\t      scopes.push(bindings);\n\t\n\t      // recursively\n\t      for (var _key5 in obj) {\n\t        var _p = path.slice(0);\n\t        _p.push(_key5);\n\t        this.setupUses(obj[_key5], _p, scopes);\n\t      }\n\t    }\n\t  }, {\n\t    key: 'beforeUpdate',\n\t    value: function beforeUpdate() {}\n\t  }, {\n\t    key: 'afterUpdate',\n\t    value: function afterUpdate() {}\n\t  }, {\n\t    key: 'update',\n\t    value: function update() {\n\t      for (var _len2 = arguments.length, args = Array(_len2), _key6 = 0; _key6 < _len2; _key6++) {\n\t        args[_key6] = arguments[_key6];\n\t      }\n\t\n\t      return this.updateMulti(args);\n\t    }\n\t  }, {\n\t    key: 'updateMulti',\n\t    value: function updateMulti() {\n\t      for (var _len3 = arguments.length, args = Array(_len3), _key7 = 0; _key7 < _len3; _key7++) {\n\t        args[_key7] = arguments[_key7];\n\t      }\n\t\n\t      for (var i = 0; i < args.length; i++) {\n\t        var _state;\n\t\n\t        var arg = args[i];\n\t        this.beforeUpdate.apply(this, [this.state].concat(_toConsumableArray(arg)));\n\t        (_state = this._state).update.apply(_state, _toConsumableArray(arg));\n\t        this.afterUpdate.apply(this, [this.state].concat(_toConsumableArray(arg)));\n\t      }\n\t      if (!this.element) {\n\t        return this.state;\n\t      }\n\t      if (!this.patching) {\n\t        this.patching = true;\n\t        this.updated = false;\n\t        this.update_count = 0;\n\t        this._state.beforePatch();\n\t\n\t        var _patch = this.patch(this.element, this.node_func(this.state), this.node);\n\t\n\t        var _patch2 = _slicedToArray(_patch, 2);\n\t\n\t        this.element = _patch2[0];\n\t        this.node = _patch2[1];\n\t\n\t        while (this.updated) {\n\t          if (this.update_count > 4096) {\n\t            // infinite loop\n\t            throw ['infinite loop in updating', args];\n\t          }\n\t          // if state is updated when patching, patch again\n\t          this.updated = false;\n\t          this._state.beforePatch();\n\t\n\t          var _patch3 = this.patch(this.element, this.node_func(this.state), this.node);\n\t\n\t          var _patch4 = _slicedToArray(_patch3, 2);\n\t\n\t          this.element = _patch4[0];\n\t          this.node = _patch4[1];\n\t        }\n\t        this.patching = false;\n\t        this.update_count = 0;\n\t      } else {\n\t        // state updated when patching\n\t        this.updated = true;\n\t        this.update_count++;\n\t      }\n\t      return this.state;\n\t    }\n\t  }, {\n\t    key: 'tap',\n\t    value: function tap(fn) {\n\t      var res = fn(this.state);\n\t      if (res) {\n\t        this.update.apply(this, _toConsumableArray(Array.isArray(res) ? res : [res]));\n\t      }\n\t    }\n\t  }, {\n\t    key: 'html',\n\t    value: function html() {\n\t      return this.element.innerHTML;\n\t    }\n\t  }, {\n\t    key: 'get',\n\t    value: function get() {\n\t      for (var _len4 = arguments.length, args = Array(_len4), _key8 = 0; _key8 < _len4; _key8++) {\n\t        args[_key8] = arguments[_key8];\n\t      }\n\t\n\t      var path = args;\n\t      if (path.length == 1 && Array.isArray(path[0])) {\n\t        path = path[0];\n\t      }\n\t      var obj = this.state;\n\t      for (var i = 0; i < path.length; i++) {\n\t        obj = obj[path[i]];\n\t      }\n\t      return obj;\n\t    }\n\t  }, {\n\t    key: 'sub',\n\t    value: function sub() {\n\t      for (var _len5 = arguments.length, args = Array(_len5), _key9 = 0; _key9 < _len5; _key9++) {\n\t        args[_key9] = arguments[_key9];\n\t      }\n\t\n\t      var path = args;\n\t      if (path.length == 1 && Array.isArray(path[0])) {\n\t        path = path[0];\n\t      }\n\t      return new _state2.SubState(this, path);\n\t    }\n\t\n\t    // patch last_element to represent node attributes, with diffing last_node\n\t\n\t  }, {\n\t    key: 'patch',\n\t    value: function patch(last_element, node, last_node) {\n\t      // thunk\n\t      var last_thunk = void 0;\n\t      if (last_node && last_node instanceof Thunk) {\n\t        last_thunk = last_node;\n\t        last_node = last_thunk.node;\n\t      }\n\t      var thunk = void 0;\n\t      if (node instanceof Thunk) {\n\t        thunk = node;\n\t      }\n\t\n\t      if (thunk) {\n\t        var should_update = false;\n\t        if (!last_thunk) {\n\t          should_update = true;\n\t        } else if (thunk.name != last_thunk.name) {\n\t          should_update = true;\n\t        } else if (this._state.argsChanged(thunk.args, last_thunk.args)) {\n\t          should_update = true;\n\t        }\n\t\n\t        if (last_thunk && !should_update) {\n\t          // reuse node\n\t          thunk.node = last_thunk.node;\n\t          // reuse element\n\t          thunk.element = last_thunk.element;\n\t        }\n\t        node = thunk.getNode();\n\t      }\n\t\n\t      // Thunk.getNode may return another Thunk, patch recursively\n\t      if (node instanceof Thunk || last_node instanceof Thunk) {\n\t        return this.patch(last_element, node, last_node);\n\t      }\n\t\n\t      // no need to patch if two Nodes is the same object\n\t      // if thunk's node is reuse, will return here\n\t      if (node === last_node) {\n\t        return [last_element, node];\n\t      }\n\t\n\t      // not patchable, build a new element\n\t      if (\n\t      // not diffable\n\t      !last_node ||\n\t      // no element\n\t      !last_element\n\t      // different tag, no way to patch\n\t      || node.tag != last_node.tag) {\n\t        var element = void 0;\n\t        if (!node || !node.toElement) {\n\t          element = warning('RENDER ERROR: cannot render ' + node).toElement();\n\t          console.warn('cannot render', node);\n\t        } else {\n\t          element = node.toElement(undefined, this);\n\t        }\n\t        // insert new then remove old\n\t        if (last_element && last_element.parentNode) {\n\t          last_element.parentNode.insertBefore(element, last_element);\n\t          last_element.parentNode.removeChild(last_element);\n\t        }\n\t        // cache last_element\n\t        if (last_node) {\n\t          this.element_cache[last_element.tagName.toLowerCase()].push([last_element, last_node]);\n\t        }\n\t\n\t        return [element, node];\n\t      }\n\t\n\t      // set element\n\t      node.element = last_element;\n\t      if (thunk) {\n\t        thunk.element = last_element;\n\t      }\n\t\n\t      return this.patchNode(last_element, node, last_node);\n\t    }\n\t  }, {\n\t    key: 'patchNode',\n\t    value: function patchNode(last_element, node, last_node) {\n\t      // innerHTML\n\t      if (node.innerHTML != last_node.innerHTML) {\n\t        last_element.innerHTML = node.innerHTML;\n\t      }\n\t\n\t      // text\n\t      if (node.text != last_node.text) {\n\t        last_element.nodeValue = node.text;\n\t      }\n\t\n\t      // id\n\t      if (node.id != last_node.id) {\n\t        last_element.id = node.id;\n\t      }\n\t\n\t      // styles\n\t      var style_type = _typeof(node.style);\n\t      var last_style_type = _typeof(last_node.style);\n\t      // different type, no diff\n\t      if (style_type !== last_style_type) {\n\t        if (style_type === 'string') {\n\t          last_element.style = node.style;\n\t        } else if (style_type === 'object' && node.style !== null) {\n\t          last_element.style = undefined;\n\t          for (var key in node.style) {\n\t            last_element.style[key] = node.style[key];\n\t          }\n\t        }\n\t      }\n\t      // diff object\n\t      else if (style_type === 'object') {\n\t          if (node.style !== null) {\n\t            for (var _key10 in node.style) {\n\t              if (!last_node.style || node.style[_key10] != last_node.style[_key10]) {\n\t                last_element.style[_key10] = node.style[_key10];\n\t              }\n\t            }\n\t          }\n\t          if (last_node.style !== null) {\n\t            for (var _key11 in last_node.style) {\n\t              if (!node.style || !(_key11 in node.style)) {\n\t                last_element.style[_key11] = '';\n\t              }\n\t            }\n\t          }\n\t        }\n\t        // string, compare\n\t        else if (style_type === 'string') {\n\t            if (node.style !== last_node.style) {\n\t              last_element.style = node.style;\n\t            }\n\t          }\n\t\n\t      // class\n\t      for (var _key12 in node.class) {\n\t        // should update\n\t        if (!last_node.class || node.class[_key12] != last_node.class[_key12]) {\n\t          if (node.class[_key12]) {\n\t            last_element.classList.add(_key12);\n\t          } else {\n\t            last_element.classList.remove(_key12);\n\t          }\n\t        }\n\t      }\n\t      for (var _key13 in last_node.class) {\n\t        if (!node.class || !(_key13 in node.class)) {\n\t          last_element.classList.remove(_key13);\n\t        }\n\t      }\n\t\n\t      // attributes\n\t      for (var _key14 in node.attributes) {\n\t        if (!last_node.attributes || node.attributes[_key14] != last_node.attributes[_key14]) {\n\t          var value = node.attributes[_key14];\n\t          var valueType = typeof value === 'undefined' ? 'undefined' : _typeof(value);\n\t          if (valueType == 'string' || valueType == 'number') {\n\t            last_element.setAttribute(_key14, value);\n\t            last_element[_key14] = value;\n\t          } else if (valueType == 'boolean') {\n\t            if (value) {\n\t              last_element.setAttribute(_key14, true);\n\t              last_element[_key14] = true;\n\t            } else {\n\t              last_element.removeAttribute(_key14);\n\t              last_element[_key14] = false;\n\t            }\n\t          }\n\t        }\n\t      }\n\t      for (var _key15 in last_node.attributes) {\n\t        if (!node.attributes || !(_key15 in node.attributes)) {\n\t          last_element.removeAttribute(_key15);\n\t          last_element[_key15] = undefined;\n\t        }\n\t      }\n\t\n\t      // events\n\t      var event_keys = {};\n\t      for (var _key16 in node.events) {\n\t        var k = elementSetEvent(last_element, _key16, node.events[_key16].bind(node));\n\t        event_keys[k] = true;\n\t      }\n\t      if (last_element.__aff_events) {\n\t        for (var ev_type in last_element.__aff_events) {\n\t          for (var ev_subtype in last_element.__aff_events[ev_type]) {\n\t            if (!(ev_type + ':' + ev_subtype in event_keys)) {\n\t              last_element.__aff_events[ev_type][ev_subtype] = false;\n\t            }\n\t          }\n\t        }\n\t      }\n\t\n\t      // children\n\t      var child_elements = last_element.childNodes;\n\t      var child_len = node.children ? node.children.length : 0;\n\t      var last_child_len = last_node && last_node.children ? last_node.children.length : 0;\n\t      for (var i = 0; i < child_len; i++) {\n\t        var _patch5 = this.patch(child_elements[i], node.children[i], last_node && last_node.children ? last_node.children[i] : undefined),\n\t            _patch6 = _slicedToArray(_patch5, 2),\n\t            elem = _patch6[0],\n\t            _ = _patch6[1];\n\t\n\t        if (!child_elements[i]) {\n\t          last_element.appendChild(elem);\n\t        }\n\t      }\n\t      for (var _i2 = child_len; _i2 < last_child_len; _i2++) {\n\t        last_element.removeChild(last_element.childNodes[child_len]);\n\t      }\n\t\n\t      if (node.hooks && node.hooks.patched) {\n\t        node.hooks.patched.forEach(function (fn) {\n\t          return fn(last_element);\n\t        });\n\t      }\n\t\n\t      return [last_element, node];\n\t    }\n\t  }, {\n\t    key: 'state',\n\t    get: function get() {\n\t      return this._state.get();\n\t    }\n\t  }]);\n\t\n\t  return App;\n\t}();\n\t\n\tvar Thunk = function () {\n\t  function Thunk() {\n\t    _classCallCheck(this, Thunk);\n\t\n\t    this.func = null;\n\t    this.args = null;\n\t    this.node = undefined;\n\t    this.element = null;\n\t    this.name = null;\n\t  }\n\t\n\t  _createClass(Thunk, [{\n\t    key: 'toElement',\n\t    value: function toElement(_name, app) {\n\t      if (!this.element) {\n\t        var node = this.getNode();\n\t        if (!node || !node.toElement) {\n\t          this.element = warning('RENDER ERROR: cannot render ' + node).toElement();\n\t          console.warn('cannot render', node);\n\t        } else {\n\t          this.element = node.toElement(this.name, app);\n\t        }\n\t      }\n\t      return this.element;\n\t    }\n\t  }, {\n\t    key: 'getNode',\n\t    value: function getNode() {\n\t      if (!this.node) {\n\t        beforeThunkCallFunc(this);\n\t        this.node = this.func.apply(this, this.args);\n\t        afterThunkCallFunc(this);\n\t        if (this.node === null) {\n\t          this.node = e('div', { style: { display: 'none' } });\n\t        }\n\t        if (!this.node) {\n\t          throw ['constructor of ' + (this.name || 'anonymous') + ' returned undefined value', this];\n\t        }\n\t      }\n\t      return this.node;\n\t    }\n\t  }]);\n\t\n\t  return Thunk;\n\t}();\n\t\n\t// thunk helper\n\t\n\t\n\tfunction t() {\n\t  for (var _len6 = arguments.length, args = Array(_len6), _key17 = 0; _key17 < _len6; _key17++) {\n\t    args[_key17] = arguments[_key17];\n\t  }\n\t\n\t  if (args.length == 0) {\n\t    throw ['no arguments to t()'];\n\t  }\n\t  var thunk = new Thunk();\n\t  switch (_typeof(args[0])) {\n\t    case 'string':\n\t      // named thunk\n\t      thunk.name = args[0];\n\t      thunk.func = args[1];\n\t      thunk.args = args.slice(2);\n\t      break;\n\t    case 'function':\n\t      thunk.func = args[0];\n\t      thunk.args = args.slice(1);\n\t      thunk.name = thunk.func.name;\n\t      break;\n\t  }\n\t  if (!thunk.func) {\n\t    throw ['invalid thunk func', thunk.func];\n\t  }\n\t  return thunk;\n\t}\n\t\n\t// element helper\n\tfunction e(tag) {\n\t  if (typeof tag !== 'string') {\n\t    throw ['bad tag name', tag];\n\t  }\n\t  var node = new Node();\n\t  node.tag = tag;\n\t\n\t  for (var _len7 = arguments.length, args = Array(_len7 > 1 ? _len7 - 1 : 0), _key18 = 1; _key18 < _len7; _key18++) {\n\t    args[_key18 - 1] = arguments[_key18];\n\t  }\n\t\n\t  for (var i = 0; i < args.length; i++) {\n\t    var arg = args[i];\n\t    if (arg instanceof Node || arg instanceof Thunk) {\n\t      node.setChildren(arg);\n\t    } else if (arg instanceof _tagged.Selector) {\n\t      node.setSelector(arg.str);\n\t    } else if (arg instanceof _tagged.Css) {\n\t      node.setProperties({\n\t        style: arg.str\n\t      });\n\t    } else if (arg instanceof _event.Event) {\n\t      node.setProperties(_defineProperty({}, 'on' + arg.ev_type, arg.fn));\n\t    } else if ((typeof arg === 'undefined' ? 'undefined' : _typeof(arg)) === 'object' && arg !== null) {\n\t      if (Array.isArray(arg)) {\n\t        node.setChildren(arg);\n\t      } else {\n\t        node.setProperties(arg);\n\t      }\n\t    } else {\n\t      node.setChildren(arg);\n\t    }\n\t  }\n\t  return node;\n\t}\n\t\n\tvar beforeThunkCallFunc = function beforeThunkCallFunc(thunk) {};\n\tvar afterThunkCallFunc = function afterThunkCallFunc(thunk) {};\n\tvar setBeforeThunkCallFunc = exports.setBeforeThunkCallFunc = function setBeforeThunkCallFunc(fn) {\n\t  beforeThunkCallFunc = fn;\n\t};\n\tvar setAfterThunkCallFunc = exports.setAfterThunkCallFunc = function setAfterThunkCallFunc(fn) {\n\t  afterThunkCallFunc = fn;\n\t};\n\t\n\tvar Node = function () {\n\t  function Node() {\n\t    _classCallCheck(this, Node);\n\t\n\t    this.tag = null;\n\t    this.id = null;\n\t    this.style = null;\n\t    this.class = null;\n\t    this.children = null;\n\t    this.attributes = null;\n\t    this.events = null;\n\t    this.text = null;\n\t    this.innerHTML = null;\n\t    this.element = null;\n\t    this.hooks = null;\n\t  }\n\t\n\t  _createClass(Node, [{\n\t    key: 'setSelector',\n\t    value: function setSelector(selector) {\n\t      var parts = selector.match(/[.#][A-Za-z][A-Za-z0-9_:-]*/g);\n\t      if (parts) {\n\t        for (var i = 0, l = parts.length; i < l; i++) {\n\t          var part = parts[i];\n\t          if (part.charAt(0) == '#') {\n\t            this.id = part.substring(1);\n\t          } else if (part.charAt(0) == '.') {\n\t            this.class = this.class || {};\n\t            this.class[part.substring(1)] = true;\n\t          }\n\t        }\n\t      }\n\t    }\n\t  }, {\n\t    key: 'setProperties',\n\t    value: function setProperties(properties) {\n\t      for (var key in properties) {\n\t        if (key == 'id' || key == 'innerHTML') {\n\t          // id, innerHTML\n\t          this[key] = properties[key];\n\t        } else if (key == 'class') {\n\t          this.class = this.class || {};\n\t          var property = properties.class;\n\t          if (typeof property == 'string') {\n\t            var parts = property.match(/[A-Za-z][A-Za-z0-9_:-]*/g);\n\t            if (parts) {\n\t              for (var i = 0, l = parts.length; i < l; i++) {\n\t                var part = parts[i];\n\t                this.class[part] = true;\n\t              }\n\t            }\n\t          } else if ((typeof property === 'undefined' ? 'undefined' : _typeof(property)) == 'object' && property !== null) {\n\t            if (Array.isArray(property)) {\n\t              for (var _i3 = 0; _i3 < property.length; _i3++) {\n\t                this.class[property[_i3]] = true;\n\t              }\n\t            } else {\n\t              var classes = [];\n\t              for (var k in property) {\n\t                this.class[k] = property[k];\n\t              }\n\t            }\n\t          } else {\n\t            throw ['bad class', property];\n\t          }\n\t        } else if (key == 'style') {\n\t          // styles\n\t          this.style = properties.style;\n\t        } else if (/^on/.test(key) && typeof properties[key] === 'function') {\n\t          if (key == 'oncreated' || key == 'oncreate') {\n\t            this.hooks = this.hooks || {};\n\t            this.hooks.created = this.hooks.created || [];\n\t            this.hooks.created.push(properties[key]);\n\t          } else if (key == 'onpatch' || key == 'onpatched') {\n\t            this.hooks = this.hooks || {};\n\t            this.hooks.patched = this.hooks.patched || [];\n\t            this.hooks.patched.push(properties[key]);\n\t          } else {\n\t            // events\n\t            this.events = this.events || {};\n\t            this.events[key] = properties[key];\n\t          }\n\t        } else {\n\t          this.attributes = this.attributes || {};\n\t          this.attributes[key] = properties[key];\n\t        }\n\t      }\n\t    }\n\t  }, {\n\t    key: 'setChildren',\n\t    value: function setChildren(children) {\n\t      this.children = this.children || [];\n\t      var type = typeof children === 'undefined' ? 'undefined' : _typeof(children);\n\t      if (type === 'object' && children !== null) {\n\t        if (Array.isArray(children)) {\n\t          // flatten\n\t          for (var i = 0, l = children.length; i < l; i++) {\n\t            this.setChildren(children[i]);\n\t          }\n\t        } else {\n\t          this.children.push(children);\n\t        }\n\t      } else if (type === 'boolean' || type === 'number' || type === 'string' || type === 'symbol') {\n\t        var child = new Node();\n\t        child.text = children.toString();\n\t        this.children.push(child);\n\t      } else if (type === 'function') {\n\t        this.setChildren(children());\n\t      } else {\n\t        throw ['bad child', children];\n\t      }\n\t    }\n\t  }, {\n\t    key: 'toElement',\n\t    value: function toElement(name, app) {\n\t      var _this = this;\n\t\n\t      var element = void 0;\n\t      if (this.text !== null) {\n\t        element = document.createTextNode(this.text);\n\t      } else {\n\t        // use cached element\n\t        if (app && app.element_cache[this.tag] && app.element_cache[this.tag].length > 0) {\n\t          var _ret = function () {\n\t            var _app$element_cache$ta = app.element_cache[_this.tag].pop(),\n\t                _app$element_cache$ta2 = _slicedToArray(_app$element_cache$ta, 2),\n\t                element = _app$element_cache$ta2[0],\n\t                last_node = _app$element_cache$ta2[1];\n\t\n\t            var node = void 0;\n\t\n\t            var _app$patchNode = app.patchNode(element, _this, last_node);\n\t\n\t            var _app$patchNode2 = _slicedToArray(_app$patchNode, 2);\n\t\n\t            element = _app$patchNode2[0];\n\t            node = _app$patchNode2[1];\n\t\n\t            _this.element = element;\n\t            if (_this.hooks && _this.hooks.created) {\n\t              _this.hooks.created.forEach(function (fn) {\n\t                return fn(element);\n\t              });\n\t            }\n\t            return {\n\t              v: element\n\t            };\n\t          }();\n\t\n\t          if ((typeof _ret === 'undefined' ? 'undefined' : _typeof(_ret)) === \"object\") return _ret.v;\n\t        }\n\t        element = document.createElement(this.tag);\n\t      }\n\t      if (this.innerHTML !== null) {\n\t        element.innerHTML = this.innerHTML;\n\t      }\n\t      if (this.id !== null) {\n\t        element.id = this.id;\n\t      }\n\t      if (this.style !== null) {\n\t        if (_typeof(this.style) == 'object' && this.style !== null) {\n\t          for (var key in this.style) {\n\t            element.style[key] = this.style[key];\n\t          }\n\t        } else {\n\t          element.style = this.style;\n\t        }\n\t      }\n\t      if (this.class !== null) {\n\t        var className = '';\n\t        for (var k in this.class) {\n\t          if (this.class[k]) {\n\t            className = className + k + ' ';\n\t          }\n\t        }\n\t        element.className = className.trim();\n\t      }\n\t      if (this.children !== null) {\n\t        var childFragment = document.createDocumentFragment();\n\t        for (var i = 0, l = this.children.length; i < l; i++) {\n\t          if (!this.children[i] || !this.children[i].toElement) {\n\t            childFragment.appendChild(warning('RENDER ERROR: cannot render ' + this.children[i]).toElement());\n\t            console.warn('cannot render', this.children[i]);\n\t          } else {\n\t            childFragment.appendChild(this.children[i].toElement(undefined, app));\n\t          }\n\t        }\n\t        element.appendChild(childFragment);\n\t      }\n\t      if (this.attributes !== null) {\n\t        for (var _key19 in this.attributes) {\n\t          var value = this.attributes[_key19];\n\t          var valueType = typeof value === 'undefined' ? 'undefined' : _typeof(value);\n\t          if (valueType == 'string' || valueType == 'number') {\n\t            element.setAttribute(_key19, value);\n\t            element[_key19] = value;\n\t          } else if (valueType == 'boolean') {\n\t            if (value) {\n\t              element.setAttribute(_key19, true);\n\t              element[_key19] = true;\n\t            } else {\n\t              element.removeAttribute(_key19);\n\t              element[_key19] = false;\n\t            }\n\t          }\n\t        }\n\t      }\n\t      if (this.events !== null) {\n\t        for (var _key20 in this.events) {\n\t          // set event callback, bind current Node to callback\n\t          // constructor must not be arrow function to get proper 'this'\n\t          elementSetEvent(element, _key20, this.events[_key20].bind(this));\n\t        }\n\t      }\n\t      this.element = element;\n\t      if (this.hooks && this.hooks.created) {\n\t        this.hooks.created.forEach(function (fn) {\n\t          return fn(element);\n\t        });\n\t      }\n\t      return element;\n\t    }\n\t  }]);\n\t\n\t  return Node;\n\t}();\n\t\n\tvar warning = function warning(text) {\n\t  return e('div', {\n\t    style: {\n\t      backgroundColor: 'yellow',\n\t      color: 'red',\n\t      fontWeight: 'bold'\n\t    }\n\t  }, text);\n\t};\n\t\n\tfunction elementSetEvent(element, ev_type, fn) {\n\t  var events = element.__aff_events;\n\t  if (!events) {\n\t    events = {};\n\t    element.__aff_events = events;\n\t  }\n\t  var parts = ev_type.split(/[$:]/);\n\t  ev_type = parts[0];\n\t  var ev_subtype = parts.slice(1).join(':') || '__default';\n\t  if (!(ev_type in events)) {\n\t    events[ev_type] = {};\n\t  }\n\t  if (!(ev_subtype in events[ev_type])) {\n\t    element.addEventListener(ev_type.substr(2), function (ev) {\n\t      return events[ev_type][ev_subtype](ev);\n\t    });\n\t  }\n\t  events[ev_type][ev_subtype] = fn;\n\t  return ev_type + ':' + ev_subtype;\n\t}\n\n/***/ },\n/* 5 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.MutableState = undefined;\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\texports.readOnly = readOnly;\n\t\n\tvar _state = __webpack_require__(2);\n\t\n\tfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar MutableState = exports.MutableState = function (_State) {\n\t  _inherits(MutableState, _State);\n\t\n\t  function MutableState(init_state, app) {\n\t    _classCallCheck(this, MutableState);\n\t\n\t    var _this = _possibleConstructorReturn(this, (MutableState.__proto__ || Object.getPrototypeOf(MutableState)).call(this));\n\t\n\t    _this.app = app;\n\t    _this.patch_tick = 1;\n\t    _this.dirty_tree = {};\n\t    _this.next_dirty_tree = {};\n\t    _this.state = init_state;\n\t    _this.setupState(_this.state, []);\n\t    return _this;\n\t  }\n\t\n\t  _createClass(MutableState, [{\n\t    key: 'get',\n\t    value: function get() {\n\t      return this.state;\n\t    }\n\t  }, {\n\t    key: 'update',\n\t    value: function update() {\n\t      for (var _len = arguments.length, arg = Array(_len), _key = 0; _key < _len; _key++) {\n\t        arg[_key] = arguments[_key];\n\t      }\n\t\n\t      this.state = this.updateState.apply(this, [this.next_dirty_tree, [], this.state].concat(arg));\n\t    }\n\t  }, {\n\t    key: 'updateState',\n\t    value: function updateState(dirty_tree, base_path, obj) {\n\t      for (var _len2 = arguments.length, args = Array(_len2 > 3 ? _len2 - 3 : 0), _key2 = 3; _key2 < _len2; _key2++) {\n\t        args[_key2 - 3] = arguments[_key2];\n\t      }\n\t\n\t      if (args.length === 0) {\n\t        return obj;\n\t      } else if (args.length === 1) {\n\t        var ret = void 0;\n\t        if (_typeof(args[0]) === 'object' && args[0] !== null && args[0].__is_op) {\n\t          ret = args[0].apply(obj, this);\n\t          if (ret === obj) {\n\t            this.setupPatchTick(ret);\n\t          }\n\t        } else {\n\t          ret = args[0];\n\t        }\n\t        this.setupState(ret, base_path);\n\t        return ret;\n\t      } else {\n\t        if (!obj) {\n\t          obj = {};\n\t        }\n\t        if ((typeof obj === 'undefined' ? 'undefined' : _typeof(obj)) === 'object' && obj !== null) {\n\t          if (!obj.hasOwnProperty('__aff_tick')) {\n\t            this.setupPatchTick(obj);\n\t          }\n\t          var key = args[0];\n\t          var key_type = typeof key === 'undefined' ? 'undefined' : _typeof(key);\n\t          for (var k in obj) {\n\t            if ((key_type === 'number' || key_type === 'string') && k == key) {\n\t              if (!dirty_tree[k]) {\n\t                dirty_tree[k] = {};\n\t              }\n\t              var path = base_path.slice(0);\n\t              path.push(k);\n\t              obj[k] = this.updateState.apply(this, [dirty_tree[k], path, obj[k]].concat(_toConsumableArray(args.slice(1))));\n\t            } else if (key_type === 'function' && key(k)) {\n\t              if (!dirty_tree[k]) {\n\t                dirty_tree[k] = {};\n\t              }\n\t              var _path = base_path.slice(0);\n\t              _path.push(k);\n\t              obj[k] = this.updateState.apply(this, [dirty_tree[k], _path, obj[k]].concat(_toConsumableArray(args.slice(1))));\n\t            }\n\t          }\n\t          if ((key_type === 'string' || key_type === 'number') && !(key in obj)) {\n\t            if (!dirty_tree[key]) {\n\t              dirty_tree[key] = {};\n\t            }\n\t            var _path2 = base_path.slice(0);\n\t            _path2.push(key);\n\t            obj[key] = this.updateState.apply(this, [dirty_tree[key], _path2, undefined].concat(_toConsumableArray(args.slice(1))));\n\t          }\n\t          obj.__aff_tick = this.patch_tick + 1;\n\t          return obj;\n\t        } else {\n\t          throw ['bad update path', obj, args];\n\t        }\n\t      }\n\t    }\n\t  }, {\n\t    key: 'beforePatch',\n\t    value: function beforePatch() {\n\t      this.patch_tick++;\n\t      this.dirty_tree = this.next_dirty_tree;\n\t      this.next_dirty_tree = {};\n\t    }\n\t  }, {\n\t    key: 'setupPatchTick',\n\t    value: function setupPatchTick(obj) {\n\t      if (obj.hasOwnProperty('__aff_tick')) {\n\t        obj.__aff_tick = this.patch_tick + 1;\n\t      } else {\n\t        Object.defineProperty(obj, '__aff_tick', {\n\t          configurable: false,\n\t          enumerable: false,\n\t          writable: true,\n\t          value: this.patch_tick + 1\n\t        });\n\t      }\n\t    }\n\t  }, {\n\t    key: 'argsChanged',\n\t    value: function argsChanged(arg, last_arg) {\n\t      var arg_type = typeof arg === 'undefined' ? 'undefined' : _typeof(arg);\n\t      var last_arg_type = typeof last_arg === 'undefined' ? 'undefined' : _typeof(last_arg);\n\t\n\t      // different type\n\t      if (arg_type !== last_arg_type) {\n\t        return true;\n\t      }\n\t\n\t      // trigger update of used keys\n\t      if (arg === last_arg && (typeof arg === 'undefined' ? 'undefined' : _typeof(arg)) === 'object' && arg != null && arg.__aff_use_keys) {\n\t        for (var key in arg.__aff_use_keys) {\n\t          // trigger getter to update __aff_tick\n\t          arg[key];\n\t        }\n\t      }\n\t\n\t      // sub state\n\t      if (arg instanceof _state.SubState && last_arg instanceof _state.SubState) {\n\t        // check path and dirty state\n\t        var max_dirty_index = -1;\n\t        var max_same_index = -1;\n\t        var dirty_tree = this.dirty_tree;\n\t        var last_path = last_arg.path;\n\t        for (var index = 0; index < arg.path.length; index++) {\n\t          if (dirty_tree && dirty_tree[arg.path[index]]) {\n\t            dirty_tree = dirty_tree[arg.path[index]];\n\t            max_dirty_index = index;\n\t          }\n\t          if (last_path[index] == arg.path[index]) {\n\t            max_same_index = index;\n\t          }\n\t        }\n\t        if (max_dirty_index == arg.path.length - 1) {\n\t          return true;\n\t        }\n\t        if (max_same_index != arg.path.length - 1) {\n\t          return true;\n\t        }\n\t      }\n\t\n\t      // patch_tick\n\t      else if (arg === last_arg && (typeof arg === 'undefined' ? 'undefined' : _typeof(arg)) === 'object' && arg !== null && arg.__aff_tick === this.patch_tick) {\n\t          return true;\n\t        }\n\t\n\t        // array\n\t        else if (Array.isArray(arg) && Array.isArray(last_arg)) {\n\t            // different length\n\t            if (arg.length != last_arg.length) {\n\t              return true;\n\t            }\n\t            // check items\n\t            for (var i = 0; i < arg.length; i++) {\n\t              if (this.argsChanged(arg[i], last_arg[i])) {\n\t                return true;\n\t              }\n\t            }\n\t          }\n\t\n\t          // deep compare object\n\t          else if (arg_type === 'object') {\n\t              // different keys length\n\t              if (Object.keys(arg).length != Object.keys(last_arg).length) {\n\t                return true;\n\t              }\n\t              for (var _key3 in arg) {\n\t                if (this.argsChanged(arg[_key3], last_arg[_key3])) {\n\t                  return true;\n\t                }\n\t              }\n\t            }\n\t\n\t            // function\n\t            else if (arg_type === 'function') {\n\t                if (arg.name !== last_arg.name) {\n\t                  return true;\n\t                }\n\t              }\n\t\n\t              // compare\n\t              else if (arg !== last_arg) {\n\t                  return true;\n\t                }\n\t\n\t      return false;\n\t    }\n\t  }, {\n\t    key: 'setupState',\n\t    value: function setupState(state, base_path) {\n\t      var _this2 = this;\n\t\n\t      if ((typeof state === 'undefined' ? 'undefined' : _typeof(state)) != 'object' || state === null) {\n\t        return;\n\t      }\n\t      if (state.__aff_read_only) {\n\t        return;\n\t      }\n\t\n\t      if (!state.hasOwnProperty('$update')) {\n\t        (function () {\n\t          // set\n\t          var app = _this2.app;\n\t          Object.defineProperty(state, '$update', {\n\t            configurable: false,\n\t            enumerable: false,\n\t            writable: false,\n\t            value: function value() {\n\t              for (var _len3 = arguments.length, args = Array(_len3), _key4 = 0; _key4 < _len3; _key4++) {\n\t                args[_key4] = arguments[_key4];\n\t              }\n\t\n\t              app.update.apply(app, _toConsumableArray(this.$path).concat(args));\n\t              return app.get(this.$path);\n\t            }\n\t          });\n\t          Object.defineProperty(state, '$sub', {\n\t            configurable: false,\n\t            enumerable: false,\n\t            writable: false,\n\t            value: function value() {\n\t              for (var _len4 = arguments.length, args = Array(_len4), _key5 = 0; _key5 < _len4; _key5++) {\n\t                args[_key5] = arguments[_key5];\n\t              }\n\t\n\t              return app.sub.apply(app, _toConsumableArray(this.$path).concat(args));\n\t            }\n\t          });\n\t          Object.defineProperty(state, '$path', {\n\t            configurable: false,\n\t            enumerable: false,\n\t            writable: true,\n\t            value: base_path.slice(0)\n\t          });\n\t        })();\n\t      } else {\n\t        // update path\n\t        state.$path = base_path.slice(0);\n\t      }\n\t\n\t      // recursively\n\t      for (var key in state) {\n\t        var sub_path = base_path.slice(0);\n\t        sub_path.push(key);\n\t        this.setupState(state[key], sub_path);\n\t      }\n\t    }\n\t  }]);\n\t\n\t  return MutableState;\n\t}(_state.State);\n\t\n\tfunction readOnly(obj) {\n\t  if ((typeof obj === 'undefined' ? 'undefined' : _typeof(obj)) !== 'object' || obj === null) {\n\t    return obj;\n\t  }\n\t  Object.defineProperty(obj, '__aff_read_only', {\n\t    configurable: false,\n\t    enumerable: false,\n\t    writable: false,\n\t    value: true\n\t  });\n\t  return obj;\n\t}\n\n/***/ },\n/* 6 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.Selector = Selector;\n\texports.$ = $;\n\texports.Css = Css;\n\texports.css = css;\n\tfunction Selector(str) {\n\t  this.str = str;\n\t}\n\t\n\tfunction $(strings) {\n\t  var str = '';\n\t\n\t  for (var _len = arguments.length, values = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n\t    values[_key - 1] = arguments[_key];\n\t  }\n\t\n\t  for (var i = 0; i < strings.length; i++) {\n\t    str += strings[i];\n\t    if (values[i] !== undefined) {\n\t      str += values[i];\n\t    }\n\t  }\n\t  return new Selector(str);\n\t}\n\t\n\tfunction Css(str) {\n\t  this.str = str;\n\t}\n\t\n\tfunction css(strings) {\n\t  var str = '';\n\t\n\t  for (var _len2 = arguments.length, values = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n\t    values[_key2 - 1] = arguments[_key2];\n\t  }\n\t\n\t  for (var i = 0; i < strings.length; i++) {\n\t    str += strings[i];\n\t    if (values[i] !== undefined) {\n\t      str += values[i];\n\t    }\n\t  }\n\t  return new Css(str);\n\t}\n\n/***/ },\n/* 7 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.bindHover = undefined;\n\texports.bindFocus = bindFocus;\n\texports.bindEnter = bindEnter;\n\texports.bindOver = bindOver;\n\t\n\tvar _event = __webpack_require__(1);\n\t\n\tfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\t\n\tfunction bindFocus(state) {\n\t  var _ref;\n\t\n\t  var path = state.path.join(':');\n\t  return _ref = {}, _defineProperty(_ref, 'onfocus$' + path, function () {\n\t    state.update(true);\n\t  }), _defineProperty(_ref, 'onblur$' + path, function () {\n\t    state.update(false);\n\t  }), _ref;\n\t}\n\t\n\tfunction bindEnter(state) {\n\t  var _ref2;\n\t\n\t  var path = state.path.join(':');\n\t  return _ref2 = {}, _defineProperty(_ref2, 'onmouseenter$' + path, function () {\n\t    state.update(true);\n\t  }), _defineProperty(_ref2, 'onmouseleave$' + path, function () {\n\t    state.update(false);\n\t  }), _ref2;\n\t}\n\t\n\tfunction bindOver(state) {\n\t  var _ref3;\n\t\n\t  var path = state.path.join(':');\n\t  return _ref3 = {}, _defineProperty(_ref3, 'onmouseover$' + path, function () {\n\t    state.update(true);\n\t  }), _defineProperty(_ref3, 'onmouseout$' + path, function () {\n\t    state.update(false);\n\t  }), _ref3;\n\t}\n\t\n\tvar bindHover = exports.bindHover = bindOver;\n\n/***/ },\n/* 8 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\t\n\tfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\t\n\t// operations \n\t\n\tfunction make_argumented_method_op(name, method) {\n\t  return function () {\n\t    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n\t      args[_key] = arguments[_key];\n\t    }\n\t\n\t    return {\n\t      __is_op: true,\n\t      op: name,\n\t      args: args,\n\t      apply: function apply(obj) {\n\t        method.apply(obj, args);\n\t        return obj;\n\t      }\n\t    };\n\t  };\n\t}\n\t\n\tfunction make_argumented_method_op_new_value(name, method) {\n\t  return function () {\n\t    for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n\t      args[_key2] = arguments[_key2];\n\t    }\n\t\n\t    return {\n\t      __is_op: true,\n\t      op: name,\n\t      args: args,\n\t      apply: function apply(obj) {\n\t        return method.apply(obj, args);\n\t      }\n\t    };\n\t  };\n\t}\n\t\n\tfunction make_method_op(name, method) {\n\t  return {\n\t    __is_op: true,\n\t    op: name,\n\t    apply: function apply(obj) {\n\t      method.apply(obj);\n\t      return obj;\n\t    }\n\t  };\n\t}\n\t\n\tvar $func = function $func(fn) {\n\t  return {\n\t    __is_op: true,\n\t    op: 'func',\n\t    args: [fn],\n\t    apply: function apply(obj) {\n\t      return fn(obj);\n\t    }\n\t  };\n\t};\n\t\n\tvar $delete = function $delete(prop) {\n\t  return {\n\t    __is_op: true,\n\t    op: 'delete',\n\t    args: [prop],\n\t    apply: function apply(obj) {\n\t      delete obj[prop];\n\t      return obj;\n\t    }\n\t  };\n\t};\n\t\n\tvar $del = $delete;\n\t\n\t// numbers\n\t\n\tvar $inc = {\n\t  __is_op: true,\n\t  op: 'inc',\n\t  apply: function apply(obj) {\n\t    return (obj || 0) + 1;\n\t  }\n\t};\n\t\n\tvar $dec = {\n\t  __is_op: true,\n\t  op: 'dec',\n\t  apply: function apply(obj) {\n\t    return obj - 1;\n\t  }\n\t};\n\t\n\t// arrays\n\t\n\tvar array_ops = {};\n\t\n\t[['push', Array.prototype.push], ['unshift', Array.prototype.unshift], ['splice', Array.prototype.splice], ['fill', Array.prototype.fill], ['sort', Array.prototype.sort]].forEach(function (info) {\n\t  array_ops['$' + info[0]] = make_argumented_method_op.apply(undefined, _toConsumableArray(info));\n\t});\n\t\n\t[['filter', Array.prototype.filter], ['map', Array.prototype.map]].forEach(function (info) {\n\t  array_ops['$' + info[0]] = make_argumented_method_op_new_value.apply(undefined, _toConsumableArray(info));\n\t});\n\t\n\t[['pop', Array.prototype.pop], ['shift', Array.prototype.shift], ['reverse', Array.prototype.reverse]].forEach(function (info) {\n\t  array_ops['$' + info[0]] = make_method_op.apply(undefined, _toConsumableArray(info));\n\t});\n\t\n\t// predictions\n\t\n\tfunction $any(k) {\n\t  return true;\n\t}\n\t\n\t// export\n\t\n\tmodule.exports = _extends({\n\t  $func: $func,\n\t  $delete: $delete,\n\t  $del: $del,\n\t  $inc: $inc,\n\t  $dec: $dec\n\t}, array_ops, {\n\t  $any: $any\n\t});\n\n/***/ },\n/* 9 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\t\n\tvar _app = __webpack_require__(4);\n\t\n\tvar _all_tags = __webpack_require__(3);\n\t\n\tvar helpers = _all_tags.all_tags.reduce(function (helpers, tag) {\n\t  helpers[tag] = function () {\n\t    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n\t      args[_key] = arguments[_key];\n\t    }\n\t\n\t    return _app.e.apply(undefined, [tag].concat(args));\n\t  };\n\t  helpers[tag.charAt(0).toUpperCase() + tag.slice(1)] = helpers[tag];\n\t  helpers[tag.toUpperCase()] = helpers[tag];\n\t  return helpers;\n\t}, {});\n\t\n\tvar checkbox = function checkbox() {\n\t  for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n\t    args[_key2] = arguments[_key2];\n\t  }\n\t\n\t  return _app.e.apply(undefined, ['input', {\n\t    type: 'checkbox'\n\t  }].concat(args));\n\t};\n\t\n\tmodule.exports = _extends({}, helpers, {\n\t\n\t  none: (0, _app.e)('div', {\n\t    style: {\n\t      display: 'none'\n\t    }\n\t  }),\n\t\n\t  clear: (0, _app.e)('div', {\n\t    style: {\n\t      clear: 'both'\n\t    }\n\t  }),\n\t\n\t  checkbox: checkbox,\n\t  Checkbox: checkbox,\n\t  CHECKBOX: checkbox\n\t});\n\n/***/ }\n/******/ ])\n});\n;\n\n\n// WEBPACK FOOTER //\n// affjs.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap a297f4884d405cca9de8","export * from './app';\nexport * from './operations';\nexport * from './tags';\nexport * from './tagged';\nexport * from './event';\nexport * from './mutable_state';\nexport * from './state';\nexport * from './bind';\n\n\n\n// WEBPACK FOOTER //\n// ./index.js","export function Event(ev_type, fn) {\n  this.ev_type = ev_type;\n  this.fn = fn;\n}\n\nexport function on(ev_type, fn) {\n  return new Event(ev_type, fn);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./event.js","export class State {\n  get() {}\n  update() {}\n  beforePatch() {}\n  argsChanged() {}\n}\n\nexport class SubState {\n  constructor(app, path) {\n    this.app = app;\n    this.path = path;\n  }\n\n  get() {\n    return this.app.get(this.path);\n  }\n\n  update(...args) {\n    return this.app.update(...this.path, ...args);\n  }\n\n  sub(...args) {\n    let subpath = args;\n    if (subpath.length == 1 && Array.isArray(subpath[0])) {\n      subpath = subpath[0];\n    }\n    return new SubState(this.app, [...this.path, ...subpath]);\n  }\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./state.js","export const all_tags = [\n\n  // html\n  'a', 'abbr', 'acronym', 'address', 'applet', 'area', 'article', 'aside', 'audio',\n  'b', 'base', 'basefont', 'bdi', 'bdo', 'bgsound', 'big', 'blink', 'blockquote', 'body', 'br', 'button',\n  'canvas', 'caption', 'center', 'cite', 'code', 'col', 'colgroup', 'command', 'content',\n  'data', 'datalist', 'dd', 'del', 'details', 'dfn', 'dialog', 'dir', 'div', 'dl', 'dt',\n  'element', 'em', 'embed',\n  'fieldset', 'figcaption', 'figure', 'font', 'footer', 'form', 'frame', 'frameset',\n  'head', 'header', 'hgroup', 'hr', 'html',\n  'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'h7',\n  'i', 'iframe', 'image', 'img', 'input', 'ins', 'isindex',\n  'kbd', 'keygen',\n  'label', 'legend', 'li', 'link', 'listing',\n  'main', 'map', 'mark', 'marquee', 'menu', 'menuitem', 'meta', 'meter', 'multicol',\n  'nav', 'nobr', 'noembed', 'noframes', 'noscript',\n  'object', 'ol', 'optgroup', 'option', 'output',\n  'p', 'param', 'picture', 'plaintext', 'pre', 'progress',\n  'q',\n  'rp', 'rt', 'rtc', 'ruby',\n  's', 'samp', 'script', 'section', 'select', 'shadow', 'small', 'source', 'spacer', 'span', 'strike', 'strong', 'style', 'sub', 'summary', 'sup',\n  'table', 'tbody', 'td', 'template', 'textarea', 'tfoot', 'th', 'thead', 'time', 'title', 'tr', 'track', 'tt',\n  'u', 'ul',\n  'var', 'video',\n  'wbr',\n  'xmp',\n\n  // svg\n  'a', 'altGlyph', 'altGlyphDef', 'altGlyphItem', 'animate', 'animateColor', 'animateMotion', 'animateTransform', 'audio',\n  'canvas', 'circle', 'clipPath', 'color-profile', 'cursor',\n  'defs', 'desc', 'discard',\n  'ellipse',\n  'feBlend', 'feColorMatrix', 'feComponentTransfer', 'feComposite', 'feConvolveMatrix', 'feDiffuseLighting', 'feDisplacementMap', 'feDistantLight',\n  'feDropShadow', 'feFlood', 'feFuncA', 'feFuncB', 'feFuncG', 'feFuncR', 'feGaussianBlur', 'feImage', 'feMerge', 'feMergeNode', 'feMorphology',\n  'feOffset', 'fePointLight', 'feSpecularLighting', 'feSpotLight', 'feTile', 'feTurbulence', 'filter',\n  'font', 'font-face', 'font-face-format', 'font-face-name', 'font-face-src', 'font-face-uri', 'foreignObject',\n  'g', 'glyph', 'glyphRef',\n  'hatch', 'hatchpath', 'hkern',\n  'iframe', 'image',\n  'line', 'linearGradient',\n  'marker', 'mask', 'mesh', 'meshgradient', 'meshpatch', 'meshrow', 'metadata', 'missing-glyph', 'mpath',\n  'path', 'pattern', 'polygon', 'polyline',\n  'radialGradient', 'rect',\n  'script', 'set', 'solidcolor', 'stop', 'style', 'svg', 'switch', 'symbol',\n  'text', 'textPath', 'title', 'tref', 'tspan',\n  'unknown', 'use',\n  'video', 'view', 'vkern',\n\n];\n\n\n\n// WEBPACK FOOTER //\n// ./all_tags.js","import { all_tags } from './all_tags'\nimport { Selector, Css } from './tagged'\nimport { Event } from './event'\nimport { MutableState } from './mutable_state'\nimport { SubState } from './state'\n\nexport class App {\n  constructor(...args) {\n    this.node = null;\n    this.patching = false;\n    this.updated = false;\n    this.update_count = 0;\n    this.element_cache = {};\n    for (let i = 0; i < all_tags.length; i++) {\n      this.element_cache[all_tags[i]] = [];\n    }\n    this.init(...args);\n  }\n\n  init(...args) {\n    for (let i = 0; i < args.length; i++) {\n      const arg = args[i];\n      if (arg instanceof HTMLElement) {\n        this.element = arg;\n      } else if (typeof arg == 'function') {\n        this.node_func = arg;\n      } else {\n        this._state = new MutableState(arg, this);\n        this.setupUses(this._state.get());\n      }\n    }\n    if (\n      this.element !== undefined \n      && this.node_func !== undefined \n      && this._state !== undefined\n    ) {\n      this.update();\n    }\n  }\n\n  setupUses(obj, path, scopes) {\n    // skip non-object\n    if (typeof obj !== 'object' || obj === null || Array.isArray(obj)) {\n      return\n    }\n\n    // default arguments\n    path = path || [];\n    scopes = scopes || [];\n\n    // parse $use\n    let useInfos;\n    if ('$use' in obj) {\n      const use = obj['$use'];\n      if (typeof use === 'object' && use !== null) {\n        if (Array.isArray(use)) {\n          useInfos = {};\n          for (let i = 0; i < use.length; i++) {\n            const key = use[i];\n            if (key in obj) {\n              throw['use key conflict', key];\n            }\n            useInfos[key] = key;\n          }\n        } else {\n          for (const key in use) {\n            if (key in obj) {\n              throw['use key conflict', key];\n            }\n          }\n          useInfos = use;\n        }\n        delete obj['$use'];\n      } else {\n        throw['bad use', use];\n      }\n    }\n\n    const app = this;\n    function set_user_getter(obj, key, from) {\n      const parentPathOfFrom = from.slice(0);\n      parentPathOfFrom.pop();\n      if (!(key in obj)) {\n        Object.defineProperty(obj, key, {\n          configurable: false,\n          enumerable: true,\n          get: function() {\n            obj.__aff_tick = app.get(parentPathOfFrom).__aff_tick;\n            return app.get(from);\n          },\n          set: function(v) {\n            app.update(...from, v);\n          },\n        });\n      }\n      if (!obj.__aff_use_keys) {\n        Object.defineProperty(obj, '__aff_use_keys', {\n          configurable: false,\n          writable: true,\n          enumerable: false,\n          value: {},\n        });\n      }\n      obj.__aff_use_keys[key] = true;\n    }\n\n    // setup\n    for (const key in useInfos) {\n      const name = useInfos[key];\n      // search in scopes\n      let found = false;\n      for (let i = 0; i < scopes.length; i++) {\n        const bindings = scopes[i];\n        if (name in bindings) { // found\n          found = true;\n          let stop_path = bindings[name].slice(0);\n          // check loop\n          let same_len = 0;\n          for (let idx = 0; idx < stop_path.length && idx < path.length; idx++) {\n            if (stop_path[idx] == path[idx]) {\n              same_len++\n            } else {\n              break\n            }\n          }\n          if (same_len == stop_path.length || same_len == path.length) {\n            throw['loop in $use', path, stop_path];\n          }\n          stop_path.pop();\n          const stop_length = stop_path.length;\n          let setup_path = path.slice(0);\n          while (setup_path.length > stop_length) {\n            //console.log('get', setup_path, key, 'from', bindings[name]);\n            set_user_getter(this.get(setup_path), key, bindings[name]);\n            setup_path.pop();\n          }\n        }\n      }\n      if (!found) {\n        throw[`no state named ${name}`];\n      }\n    }\n\n    // collect bindings\n    const bindings = {};\n    for (const key in obj) {\n      const p = path.slice(0);\n      p.push(key);\n      bindings[key] = p;\n    }\n    scopes = scopes.slice(0); // copy\n    scopes.push(bindings);\n\n    // recursively\n    for (let key in obj) {\n      let p = path.slice(0);\n      p.push(key);\n      this.setupUses(obj[key], p, scopes);\n    }\n\n  }\n\n  beforeUpdate() {\n  }\n\n  afterUpdate() {\n  }\n\n  get state() {\n    return this._state.get();\n  }\n\n  update(...args) {\n    return this.updateMulti(args);\n  }\n\n  updateMulti(...args) {\n    for (let i = 0; i < args.length; i++) {\n      let arg = args[i];\n      this.beforeUpdate(this.state, ...arg);\n      this._state.update(...arg);\n      this.afterUpdate(this.state, ...arg);\n    }\n    if (!this.element) {\n      return this.state;\n    }\n    if (!this.patching) {\n      this.patching = true;\n      this.updated = false;\n      this.update_count = 0;\n      this._state.beforePatch();\n      [this.element, this.node] = this.patch(\n        this.element, \n        this.node_func(this.state), \n        this.node,\n      );\n      while (this.updated) {\n        if (this.update_count > 4096) { // infinite loop\n          throw['infinite loop in updating', args];\n        }\n        // if state is updated when patching, patch again\n        this.updated = false;\n        this._state.beforePatch();\n        [this.element, this.node] = this.patch(\n          this.element,\n          this.node_func(this.state),\n          this.node,\n        );\n      }\n      this.patching = false;\n      this.update_count = 0;\n    } else {\n      // state updated when patching\n      this.updated = true;\n      this.update_count++;\n    }\n    return this.state;\n  }\n\n  tap(fn) {\n    const res = fn(this.state);\n    if (res) {\n      this.update(...(Array.isArray(res) ? res : [res]));\n    }\n  }\n\n  html() {\n    return this.element.innerHTML;\n  }\n\n  get(...args) {\n    let path = args;\n    if (path.length == 1 && Array.isArray(path[0])) {\n      path = path[0];\n    }\n    let obj = this.state;\n    for (let i = 0; i < path.length; i++) {\n      obj = obj[path[i]];\n    }\n    return obj;\n  }\n\n  sub(...args) {\n    let path = args;\n    if (path.length == 1 && Array.isArray(path[0])) {\n      path = path[0];\n    }\n    return new SubState(this, path);\n  }\n\n  // patch last_element to represent node attributes, with diffing last_node\n  patch(last_element, node, last_node) {\n    // thunk\n    let last_thunk;\n    if (last_node && last_node instanceof Thunk) {\n      last_thunk = last_node;\n      last_node = last_thunk.node;\n    }\n    let thunk;\n    if (node instanceof Thunk) {\n      thunk = node;\n    }\n\n    if (thunk) {\n      let should_update = false;\n      if (!last_thunk) {\n        should_update = true;\n      } else if (thunk.name != last_thunk.name) {\n        should_update = true;\n      } else if (this._state.argsChanged(thunk.args, last_thunk.args)) {\n        should_update = true;\n      }\n\n      if (last_thunk && !should_update) {\n        // reuse node\n        thunk.node = last_thunk.node;\n        // reuse element\n        thunk.element = last_thunk.element;\n      }\n      node = thunk.getNode();\n    }\n\n    // Thunk.getNode may return another Thunk, patch recursively\n    if (node instanceof Thunk || last_node instanceof Thunk) {\n      return this.patch(last_element, node, last_node);\n    }\n\n    // no need to patch if two Nodes is the same object\n    // if thunk's node is reuse, will return here\n    if (node === last_node) {\n      return [last_element, node];\n    }\n\n    // not patchable, build a new element\n    if (\n      // not diffable\n      (!last_node)\n      // no element\n      || (!last_element)\n      // different tag, no way to patch\n      || (node.tag != last_node.tag)\n    ) {\n      let element;\n      if (!node || !node.toElement) {\n        element = warning(`RENDER ERROR: cannot render ${node}`).toElement();\n        console.warn('cannot render', node);\n      } else {\n        element = node.toElement(undefined, this);\n      }\n      // insert new then remove old\n      if (last_element && last_element.parentNode) {\n        last_element.parentNode.insertBefore(element, last_element);\n        last_element.parentNode.removeChild(last_element);\n      }\n      // cache last_element\n      if (last_node) {\n        this.element_cache[last_element.tagName.toLowerCase()].push([last_element, last_node]);\n      }\n\n      return [element, node];\n    }\n\n    // set element\n    node.element = last_element;\n    if (thunk) {\n      thunk.element = last_element;\n    }\n\n    return this.patchNode(last_element, node, last_node);\n  }\n\n  patchNode(last_element, node, last_node) {\n    // innerHTML\n    if (node.innerHTML != last_node.innerHTML) {\n      last_element.innerHTML = node.innerHTML;\n    }\n\n    // text\n    if (node.text != last_node.text) {\n      last_element.nodeValue = node.text;\n    }\n\n    // id\n    if (node.id != last_node.id) {\n      last_element.id = node.id;\n    }\n\n    // styles\n    const style_type = typeof node.style;\n    const last_style_type = typeof last_node.style;\n    // different type, no diff\n    if (style_type !== last_style_type) {\n      if (style_type === 'string') {\n        last_element.style = node.style;\n      } else if (style_type === 'object' && node.style !== null) {\n        last_element.style = undefined;\n        for (const key in node.style) {\n          last_element.style[key] = node.style[key];\n        }\n      }\n    } \n    // diff object\n    else if (style_type === 'object') {\n      if (node.style !== null) {\n        for (const key in node.style) {\n          if (!last_node.style || node.style[key] != last_node.style[key]) {\n            last_element.style[key] = node.style[key];\n          }\n        }\n      }\n      if (last_node.style !== null) {\n        for (const key in last_node.style) {\n          if (!node.style || !(key in node.style)) {\n            last_element.style[key] = '';\n          }\n        }\n      }\n    } \n    // string, compare\n    else if (style_type === 'string') {\n      if (node.style !== last_node.style) {\n        last_element.style = node.style;\n      }\n    }\n\n    // class\n    for (const key in node.class) {\n      // should update\n      if (!last_node.class || node.class[key] != last_node.class[key]) {\n        if (node.class[key]) {\n          last_element.classList.add(key);\n        } else {\n          last_element.classList.remove(key);\n        }\n      }\n    }\n    for (const key in last_node.class) {\n      if (!node.class || !(key in node.class)) {\n        last_element.classList.remove(key);\n      }\n    }\n\n    // attributes\n    for (const key in node.attributes) {\n      if (!last_node.attributes || node.attributes[key] != last_node.attributes[key]) {\n        const value = node.attributes[key];\n        const valueType = typeof value;\n        if (valueType == 'string' || valueType == 'number') {\n          last_element.setAttribute(key, value);\n          last_element[key] = value\n        } else if (valueType == 'boolean') {\n          if (value) {\n            last_element.setAttribute(key, true);\n            last_element[key] = true;\n          } else {\n            last_element.removeAttribute(key);\n            last_element[key] = false;\n          }\n        }\n      }\n    }\n    for (const key in last_node.attributes) {\n      if (!node.attributes || !(key in node.attributes)) {\n        last_element.removeAttribute(key);\n        last_element[key] = undefined;\n      }\n    }\n\n    // events\n    const event_keys = {};\n    for (const key in node.events) {\n      let k = elementSetEvent(last_element, key, node.events[key].bind(node));\n      event_keys[k] = true;\n    }\n    if (last_element.__aff_events) {\n      for (const ev_type in last_element.__aff_events) {\n        for (const ev_subtype in last_element.__aff_events[ev_type]) {\n          if (!(ev_type + ':' + ev_subtype in event_keys)) {\n            last_element.__aff_events[ev_type][ev_subtype] = false;\n          }\n        }\n      }\n    }\n\n    // children\n    const child_elements = last_element.childNodes;\n    const child_len = node.children ? node.children.length : 0;\n    const last_child_len = last_node && last_node.children ? last_node.children.length : 0;\n    for (let i = 0; i < child_len; i++) {\n      const [elem, _] = this.patch(\n        child_elements[i], \n        node.children[i], \n        last_node && last_node.children ? last_node.children[i] : undefined,\n      );\n      if (!child_elements[i]) {\n        last_element.appendChild(elem);\n      }\n    }\n    for (let i = child_len; i < last_child_len; i++) {\n      last_element.removeChild(last_element.childNodes[child_len]);\n    }\n\n    if (node.hooks && node.hooks.patched) {\n      node.hooks.patched.forEach(fn => fn(last_element));\n    }\n\n    return [last_element, node];\n  }\n}\n\nclass Thunk {\n  constructor() {\n    this.func = null;\n    this.args = null;\n    this.node = undefined;\n    this.element = null;\n    this.name = null;\n  }\n\n  toElement(_name, app) {\n    if (!this.element) {\n      const node = this.getNode();\n      if (!node || !node.toElement) {\n        this.element = warning(`RENDER ERROR: cannot render ${node}`).toElement();\n        console.warn('cannot render', node);\n      } else {\n        this.element = node.toElement(this.name, app);\n      }\n    }\n    return this.element;\n  }\n\n  getNode() {\n    if (!this.node) {\n      beforeThunkCallFunc(this);\n      this.node = this.func.apply(this, this.args);\n      afterThunkCallFunc(this);\n      if (this.node === null) {\n        this.node = e('div', { style: { display: 'none' }});\n      }\n      if (!this.node) {\n        throw['constructor of ' + (this.name || 'anonymous') + ' returned undefined value', this];\n      }\n    }\n    return this.node;\n  }\n\n}\n\n// thunk helper\nexport function t(...args) {\n  if (args.length == 0) {\n    throw['no arguments to t()'];\n  }\n  const thunk = new Thunk();\n  switch (typeof args[0]) {\n  case 'string': // named thunk\n    thunk.name = args[0];\n    thunk.func = args[1];\n    thunk.args = args.slice(2);\n    break\n  case 'function':\n    thunk.func = args[0];\n    thunk.args = args.slice(1);\n    thunk.name = thunk.func.name;\n    break\n  }\n  if (!thunk.func) {\n    throw['invalid thunk func', thunk.func];\n  }\n  return thunk\n}\n\n// element helper\nexport function e(tag, ...args) {\n  if (typeof tag !== 'string') {\n    throw['bad tag name', tag];\n  }\n  const node = new Node();\n  node.tag = tag;\n  for (let i = 0; i < args.length; i++) {\n    const arg = args[i];\n    if (arg instanceof Node || arg instanceof Thunk) {\n      node.setChildren(arg);\n    } else if (arg instanceof Selector) {\n      node.setSelector(arg.str);\n    } else if (arg instanceof Css) {\n      node.setProperties({\n        style: arg.str,\n      });\n    } else if (arg instanceof Event) {\n      node.setProperties({\n        ['on' + arg.ev_type]: arg.fn,\n      });\n    } else if (typeof arg === 'object' && arg !== null) {\n      if (Array.isArray(arg)) {\n        node.setChildren(arg)\n      } else {\n        node.setProperties(arg);\n      }\n    } else {\n      node.setChildren(arg);\n    }\n  }\n  return node;\n}\n\nlet beforeThunkCallFunc = (thunk) => {};\nlet afterThunkCallFunc = (thunk) => {};\nexport const setBeforeThunkCallFunc = (fn) => {\n  beforeThunkCallFunc = fn;\n}\nexport const setAfterThunkCallFunc = (fn) => {\n  afterThunkCallFunc = fn;\n}\n\nclass Node {\n  constructor() {\n    this.tag = null;\n    this.id = null;\n    this.style = null;\n    this.class = null;\n    this.children = null;\n    this.attributes = null;\n    this.events = null;\n    this.text = null;\n    this.innerHTML = null;\n    this.element = null;\n    this.hooks = null;\n  }\n\n  setSelector(selector) {\n    const parts = selector.match(/[.#][A-Za-z][A-Za-z0-9_:-]*/g);\n    if (parts) {\n      for (let i = 0, l = parts.length; i < l; i++) {\n        const part = parts[i];\n        if (part.charAt(0) == '#') {\n          this.id = part.substring(1);\n        } else if (part.charAt(0) == '.') {\n          this.class = this.class || {};\n          this.class[part.substring(1)] = true;\n        }\n      }\n    }\n  }\n\n  setProperties(properties) {\n    for (const key in properties) {\n      if (key == 'id' || key == 'innerHTML') {\n        // id, innerHTML\n        this[key] = properties[key];\n      } else if (key == 'class') {\n        this.class = this.class || {};\n        const property = properties.class;\n        if (typeof property == 'string') {\n          const parts = property.match(/[A-Za-z][A-Za-z0-9_:-]*/g);\n          if (parts) {\n            for (let i = 0, l = parts.length; i < l; i++) {\n              const part = parts[i];\n              this.class[part] = true;\n            }\n          }\n        } else if (typeof property == 'object' && property !== null) {\n          if (Array.isArray(property)) {\n            for (let i = 0; i < property.length; i++) {\n              this.class[property[i]] = true;\n            }\n          } else {\n            const classes = [];\n            for (const k in property) {\n              this.class[k] = property[k];\n            }\n          }\n        } else {\n          throw['bad class', property];\n        }\n      } else if (key == 'style') {\n        // styles\n        this.style = properties.style;\n      } else if (/^on/.test(key) && typeof properties[key] === 'function') {\n        if (key == 'oncreated' || key == 'oncreate') {\n          this.hooks = this.hooks || {};\n          this.hooks.created = this.hooks.created || [];\n          this.hooks.created.push(properties[key]);\n        } else if (key == 'onpatch' || key == 'onpatched') {\n          this.hooks = this.hooks || {};\n          this.hooks.patched = this.hooks.patched || [];\n          this.hooks.patched.push(properties[key]);\n        } else {\n          // events\n          this.events = this.events || {};\n          this.events[key] = properties[key];\n        }\n      } else {\n        this.attributes = this.attributes || {};\n        this.attributes[key] = properties[key];\n      }\n    }\n  }\n\n  setChildren(children) {\n    this.children = this.children || [];\n    const type = typeof children;\n    if (type === 'object' && children !== null) {\n      if (Array.isArray(children)) {\n        // flatten\n        for (let i = 0, l = children.length; i < l; i++) {\n          this.setChildren(children[i]);\n        }\n      } else {\n        this.children.push(children);\n      }\n    } else if (type === 'boolean' || type === 'number' || type === 'string' || type === 'symbol') {\n      const child = new Node();\n      child.text = children.toString();\n      this.children.push(child);\n    } else if (type === 'function') {\n      this.setChildren(children());\n    } else {\n      throw['bad child', children];\n    }\n  }\n\n  toElement(name, app) {\n    let element;\n    if (this.text !== null) {\n      element = document.createTextNode(this.text);\n    } else {\n      // use cached element\n      if (app && app.element_cache[this.tag] && app.element_cache[this.tag].length > 0) {\n        let [element, last_node] = app.element_cache[this.tag].pop();\n        let node;\n        [element, node] = app.patchNode(element, this, last_node);\n        this.element = element;\n        if (this.hooks && this.hooks.created) {\n          this.hooks.created.forEach(fn => fn(element));\n        }\n        return element;\n      }\n      element = document.createElement(this.tag);\n    }\n    if (this.innerHTML !== null) {\n      element.innerHTML = this.innerHTML;\n    }\n    if (this.id !== null) {\n      element.id = this.id;\n    }\n    if (this.style !== null) {\n      if (typeof this.style == 'object' && this.style !== null) {\n        for (const key in this.style) {\n          element.style[key] = this.style[key];\n        }\n      } else {\n        element.style = this.style;\n      }\n    }\n    if (this.class !== null) {\n      let className = '';\n      for (let k in this.class) {\n        if (this.class[k]) {\n          className = className + k + ' ';\n        }\n      }\n      element.className = className.trim();\n    }\n    if (this.children !== null) {\n      const childFragment = document.createDocumentFragment();\n      for (let i = 0, l = this.children.length; i < l; i++) {\n        if (!this.children[i] || !this.children[i].toElement) {\n          childFragment.appendChild(warning(`RENDER ERROR: cannot render ${this.children[i]}`).toElement());\n          console.warn('cannot render', this.children[i]);\n        } else {\n          childFragment.appendChild(this.children[i].toElement(undefined, app));\n        }\n      }\n      element.appendChild(childFragment);\n    }\n    if (this.attributes !== null) {\n      for (const key in this.attributes) {\n        const value = this.attributes[key];\n        const valueType = typeof value;\n        if (valueType == 'string' || valueType == 'number') {\n          element.setAttribute(key, value);\n          element[key] = value;\n        } else if (valueType == 'boolean') {\n          if (value) {\n            element.setAttribute(key, true);\n            element[key] = true;\n          } else {\n            element.removeAttribute(key);\n            element[key] = false;\n          }\n        }\n      }\n    }\n    if (this.events !== null) {\n      for (const key in this.events) {\n        // set event callback, bind current Node to callback\n        // constructor must not be arrow function to get proper 'this'\n        elementSetEvent(element, key, this.events[key].bind(this));\n      }\n    }\n    this.element = element;\n    if (this.hooks && this.hooks.created) {\n      this.hooks.created.forEach(fn => fn(element));\n    }\n    return element;\n  }\n\n}\n\nconst warning = (text) => e('div', {\n  style: {\n    backgroundColor: 'yellow',\n    color: 'red',\n    fontWeight: 'bold',\n  },\n}, text);\n\nfunction elementSetEvent(element, ev_type, fn) {\n  let events = element.__aff_events;\n  if (!events) {\n    events = {};\n    element.__aff_events = events;\n  }\n  const parts = ev_type.split(/[$:]/);\n  ev_type = parts[0];\n  const ev_subtype = parts.slice(1).join(':') || '__default';\n  if (!(ev_type in events)) {\n    events[ev_type] = {};\n  }\n  if (!(ev_subtype in events[ev_type])) {\n    element.addEventListener(ev_type.substr(2), function(ev) {\n      return events[ev_type][ev_subtype](ev);\n    });\n  }\n  events[ev_type][ev_subtype] = fn;\n  return ev_type + ':' + ev_subtype;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app.js","import { State, SubState } from './state'\n\nexport class MutableState extends State {\n  constructor(init_state, app) {\n    super();\n    this.app = app;\n    this.patch_tick = 1;\n    this.dirty_tree = {};\n    this.next_dirty_tree = {};\n    this.state = init_state;\n    this.setupState(this.state, []);\n  }\n\n  get() {\n    return this.state;\n  }\n\n  update(...arg) {\n    this.state = this.updateState(this.next_dirty_tree, [], this.state, ...arg);\n  }\n\n  updateState(dirty_tree, base_path, obj, ...args) {\n    if (args.length === 0) {\n      return obj;\n    } else if (args.length === 1) {\n      let ret;\n      if (typeof args[0] === 'object' && args[0] !== null && args[0].__is_op) {\n        ret = args[0].apply(obj, this);\n        if (ret === obj) {\n          this.setupPatchTick(ret);\n        }\n      } else {\n        ret = args[0];\n      }\n      this.setupState(ret, base_path);\n      return ret;\n    } else {\n      if (!obj) {\n        obj = {};\n      }\n      if (typeof obj === 'object' && obj !== null) {\n        if (!obj.hasOwnProperty('__aff_tick')) {\n          this.setupPatchTick(obj);\n        }\n        const key = args[0];\n        const key_type = typeof key;\n        for (const k in obj) {\n          if ((key_type === 'number' || key_type === 'string') && k == key) {\n            if (!dirty_tree[k]) {\n              dirty_tree[k] = {};\n            }\n            let path = base_path.slice(0);\n            path.push(k);\n            obj[k] = this.updateState(dirty_tree[k], path, obj[k], ...args.slice(1));\n          } else if (key_type === 'function' && key(k)) {\n            if (!dirty_tree[k]) {\n              dirty_tree[k] = {};\n            }\n            let path = base_path.slice(0);\n            path.push(k);\n            obj[k] = this.updateState(dirty_tree[k], path, obj[k], ...args.slice(1));\n          }\n        }\n        if ((key_type === 'string' || key_type === 'number') && !(key in obj)) {\n          if (!dirty_tree[key]) {\n            dirty_tree[key] = {};\n          }\n          let path = base_path.slice(0);\n          path.push(key);\n          obj[key] = this.updateState(dirty_tree[key], path, undefined, ...args.slice(1));\n        }\n        obj.__aff_tick = this.patch_tick + 1;\n        return obj;\n      } else {\n        throw['bad update path', obj, args];\n      }\n    }\n  }\n\n  beforePatch() {\n    this.patch_tick++;\n    this.dirty_tree = this.next_dirty_tree;\n    this.next_dirty_tree = {};\n  }\n\n  setupPatchTick(obj) {\n    if (obj.hasOwnProperty('__aff_tick')) {\n      obj.__aff_tick = this.patch_tick + 1;\n    } else {\n      Object.defineProperty(obj, '__aff_tick', {\n        configurable: false,\n        enumerable: false,\n        writable: true,\n        value: this.patch_tick + 1,\n      });\n    }\n  }\n\n  argsChanged(arg, last_arg) {\n    const arg_type = typeof arg;\n    const last_arg_type = typeof last_arg;\n\n    // different type\n    if (arg_type !== last_arg_type) {\n      return true;\n    }\n\n    // trigger update of used keys\n    if (\n      arg === last_arg\n      && typeof arg === 'object'\n      && arg != null\n      && arg.__aff_use_keys\n    ) {\n      for (const key in arg.__aff_use_keys) {\n        // trigger getter to update __aff_tick\n        arg[key];\n      }\n    }\n\n    // sub state\n    if (arg instanceof SubState && last_arg instanceof SubState) {\n      // check path and dirty state\n      let max_dirty_index = -1;\n      let max_same_index = -1;\n      let dirty_tree = this.dirty_tree;\n      const last_path = last_arg.path;\n      for (let index = 0; index < arg.path.length; index++) {\n        if (dirty_tree && dirty_tree[arg.path[index]]) {\n          dirty_tree = dirty_tree[arg.path[index]];\n          max_dirty_index = index;\n        }\n        if (last_path[index] == arg.path[index]) {\n          max_same_index = index;\n        }\n      }\n      if (max_dirty_index == arg.path.length - 1) {\n        return true;\n      }\n      if (max_same_index != arg.path.length - 1) {\n        return true;\n      }\n    } \n\n    // patch_tick\n    else if (\n      arg === last_arg \n      && typeof arg === 'object' \n      && arg !== null \n      && arg.__aff_tick === this.patch_tick\n    ) {\n      return true;\n    }\n\n    // array\n    else if (Array.isArray(arg) && Array.isArray(last_arg)) {\n      // different length\n      if (arg.length != last_arg.length) {\n        return true;\n      }\n      // check items\n      for (let i = 0; i < arg.length; i++ ){\n        if (this.argsChanged(arg[i], last_arg[i])) {\n          return true;\n        }\n      }\n    } \n\n    // deep compare object\n    else if (arg_type === 'object') {\n      // different keys length\n      if (Object.keys(arg).length != Object.keys(last_arg).length) {\n        return true;\n      }\n      for (const key in arg) {\n        if (this.argsChanged(arg[key], last_arg[key])) {\n          return true;\n        }\n      }\n    }\n\n    // function\n    else if (arg_type === 'function') {\n      if (arg.name !== last_arg.name) {\n        return true;\n      }\n    }\n\n    // compare\n    else if (arg !== last_arg) {\n      return true;\n    }\n\n    return false;\n  }\n\n  setupState(state, base_path) {\n    if (typeof state != 'object' || state === null) {\n      return\n    }\n    if (state.__aff_read_only) {\n      return\n    }\n\n    if (!state.hasOwnProperty('$update')) {\n      // set\n      const app = this.app;\n      Object.defineProperty(state, '$update', {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: function(...args) {\n          app.update(...this.$path, ...args);\n          return app.get(this.$path);\n        },\n      });\n      Object.defineProperty(state, '$sub', {\n        configurable: false,\n        enumerable: false,\n        writable: false,\n        value: function(...args) {\n          return app.sub(...this.$path, ...args);\n        },\n      });\n      Object.defineProperty(state, '$path', {\n        configurable: false,\n        enumerable: false,\n        writable: true,\n        value: base_path.slice(0),\n      });\n\n    } else {\n      // update path\n      state.$path = base_path.slice(0);\n    }\n\n    // recursively\n    for (let key in state) {\n      let sub_path = base_path.slice(0);\n      sub_path.push(key);\n      this.setupState(state[key], sub_path);\n    }\n\n  }\n}\n\nexport function readOnly(obj) {\n  if (typeof obj !== 'object' || obj === null) {\n    return obj;\n  }\n  Object.defineProperty(obj, '__aff_read_only', {\n    configurable: false,\n    enumerable: false,\n    writable: false,\n    value: true,\n  });\n  return obj;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./mutable_state.js","export function Selector(str) {\n  this.str = str;\n}\n\nexport function $(strings, ...values) {\n  let str = '';\n  for (let i = 0; i < strings.length; i++) {\n    str += strings[i];\n    if (values[i] !== undefined) {\n      str += values[i];\n    }\n  }\n  return new Selector(str);\n}\n\nexport function Css(str) {\n  this.str = str;\n}\n\nexport function css(strings, ...values) {\n  let str = '';\n  for (let i = 0; i < strings.length; i++) {\n    str += strings[i];\n    if (values[i] !== undefined) {\n      str += values[i];\n    }\n  }\n  return new Css(str);\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./tagged.js","import { on } from './event'\n\nexport function bindFocus(state) {\n  const path = state.path.join(':');\n  return {\n    ['onfocus$' + path]: function() {\n      state.update(true);\n    },\n    ['onblur$' + path]: function() {\n      state.update(false);\n    },\n  };\n}\n\nexport function bindEnter(state) {\n  const path = state.path.join(':');\n  return {\n    ['onmouseenter$' + path]: function() {\n      state.update(true);\n    },\n    ['onmouseleave$' + path]: function() {\n      state.update(false);\n    },\n  };\n}\n\nexport function bindOver(state) {\n  const path = state.path.join(':');\n  return {\n    ['onmouseover$' + path]: function() {\n      state.update(true);\n    },\n    ['onmouseout$' + path]: function() {\n      state.update(false);\n    },\n  };\n}\n\nexport let bindHover = bindOver;\n\n\n\n// WEBPACK FOOTER //\n// ./bind.js","// operations \n\nfunction make_argumented_method_op(name, method) {\n  return function(...args) {\n    return {\n      __is_op: true,\n      op: name,\n      args: args,\n      apply(obj) {\n        method.apply(obj, args);\n        return obj;\n      },\n    };\n  };\n}\n\nfunction make_argumented_method_op_new_value(name, method) {\n  return function(...args) {\n    return {\n      __is_op: true,\n      op: name,\n      args: args,\n      apply(obj) {\n        return method.apply(obj, args);\n      },\n    };\n  };\n}\n\nfunction make_method_op(name, method) {\n  return {\n    __is_op: true,\n    op: name,\n    apply(obj) {\n      method.apply(obj);\n      return obj;\n    },\n  };\n}\n\nlet $func = (fn) => ({\n  __is_op: true,\n  op: 'func',\n  args: [fn],\n  apply(obj) {\n    return fn(obj);\n  },\n});\n\nlet $delete = (prop) => ({\n  __is_op: true,\n  op: 'delete',\n  args: [prop],\n  apply(obj) {\n    delete obj[prop];\n    return obj;\n  },\n});\n\nlet $del = $delete;\n\n// numbers\n\nlet $inc = {\n  __is_op: true,\n  op: 'inc',\n  apply(obj) {\n    return (obj || 0) + 1;\n  },\n};\n\nlet $dec = {\n  __is_op: true,\n  op: 'dec',\n  apply(obj) {\n    return obj - 1;\n  }\n};\n\n// arrays\n\nlet array_ops = {};\n\n[\n  ['push', Array.prototype.push],\n  ['unshift', Array.prototype.unshift],\n  ['splice', Array.prototype.splice],\n  ['fill', Array.prototype.fill],\n  ['sort', Array.prototype.sort],\n].forEach(info => {\n  array_ops['$' + info[0]] = make_argumented_method_op(...info);\n});\n\n[\n  ['filter', Array.prototype.filter],\n  ['map', Array.prototype.map],\n].forEach(info => {\n  array_ops['$' + info[0]] = make_argumented_method_op_new_value(...info);\n});\n\n[\n  ['pop', Array.prototype.pop],\n  ['shift', Array.prototype.shift],\n  ['reverse', Array.prototype.reverse],\n].forEach(info => {\n  array_ops['$' + info[0]] = make_method_op(...info);\n});\n\n// predictions\n\nfunction $any(k) {\n  return true;\n}\n\n// export\n\nmodule.exports = {\n  $func,\n  $delete,\n  $del,\n  $inc,\n  $dec,\n  ...array_ops,\n  $any,\n};\n\n\n\n// WEBPACK FOOTER //\n// ./operations.js","import {e} from './app'\nimport { all_tags } from './all_tags'\n\nconst helpers = all_tags.reduce((helpers, tag) => {\n  helpers[tag] = function(...args) {\n    return e(tag, ...args);\n  };\n  helpers[tag.charAt(0).toUpperCase() + tag.slice(1)] = helpers[tag];\n  helpers[tag.toUpperCase()] = helpers[tag];\n  return helpers;\n}, {});\n\nconst checkbox = (...args) => e('input', {\n  type: 'checkbox',\n}, ...args);\n\nmodule.exports = {\n  ...helpers,\n\n  none: e('div', {\n    style: {\n      display: 'none',\n    },\n  }),\n\n  clear: e('div', {\n    style: {\n      clear: 'both',\n    },\n  }),\n\n  checkbox: checkbox,\n  Checkbox: checkbox,\n  CHECKBOX: checkbox,\n};\n\n\n\n// WEBPACK FOOTER //\n// ./tags.js"],"sourceRoot":""}